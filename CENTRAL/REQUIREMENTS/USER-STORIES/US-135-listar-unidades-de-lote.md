---
modules: [GEOAPI, GEOWEB, REURBCAD, GEOGIS]
epic: performance
---

# US-135: Listar Unidades de Lote

Como Analista quero listar unidades dentro de um lote para que possa visualizar ocupacoes no lote e gerenciar unidades habitacionais de forma contextualizada por subdivisao territorial, onde o endpoint implementado em GEOAPI expoe a rota /api/plots/{id}/units retornando lista paginada de unidades habitacionais pertencentes ao lote especificado, garantindo validacao de permissoes baseada em roles onde usuarios com role Analyst ou superior podem listar unidades de lotes do seu tenant, incluindo tratamento de erro 404 Not Found quando ID do lote nao existe e validacao de ownership garantindo que usuario nao acesse unidades de lotes de outros tenants, permitindo filtragem da listagem atraves de query parameters incluindo status para filtrar por DRAFT PENDING APPROVED REJECTED, search para busca textual em codigo endereco ou nome do titular, sortBy para ordenacao por code area createdAt updatedAt status e dateRange para filtrar por periodo de criacao ou atualizacao, onde a resposta inclui paginacao com page size totalCount hasNextPage hasPreviousPage firstPage lastPage e array items contendo objetos Unit com propriedades id code address area builtArea status occupationType holderName plotCode blockCode communityName createdAt updatedAt, garantindo rastreabilidade ao requisito funcional RF-084 que especifica listagem de unidades por lote, incluindo relacionamento com entidades Holder Plot Block e Community para exibir informacoes contextuais completas sem necessidade de requisicoes adicionais ao backend, permitindo que o frontend GEOWEB exiba tabela paginada com colunas configuradas codigo endereco area area construida tipo de ocupacao titular status e acoes incluindo botoes para editar visualizar no mapa imprimir ficha cadastral e excluir, onde a implementacao em GEOAPI utiliza specification pattern com expression trees para construir queries dinamicas baseadas em filtros aplicados garantindo SQL otimizado com joins necessarios e indices de banco de dados apropriados, garantindo que geometrias das unidades nao sejam incluidas na listagem para reduzir payload de resposta sendo carregadas apenas em endpoints especificos de geometria ou quando explicitamente requisitado via parametro includeGeometry, incluindo campo computado documentsCount na resposta indicando quantidade de documentos anexados a cada unidade facilitando identificacao de unidades com documentacao incompleta, permitindo export da listagem em formatos CSV Excel PDF GeoJSON e Shapefile para uso em sistemas GIS externos geracao de relatorios gerenciais e impressao de fichas cadastrais em lote, onde testes unitarios validam logica de filtragem paginacao ordenacao e construcao de especificacoes com datasets mock simulando diferentes cenarios de uso, garantindo testes de integracao que verificam recuperacao correta de unidades de lote especifico com relacionamentos eager loading validacao de isolamento multi-tenant e performance de queries com multiplos filtros aplicados simultaneamente, incluindo suporte a aggregations retornadas em response headers incluindo totalArea totalBuiltArea occupancyRate distribuicao por status e tipo de ocupacao facilitando exibicao de dashboards e graficos estatisticos sem necessidade de requisicoes adicionais.

---

**Ultima atualizacao:** 2025-12-30
