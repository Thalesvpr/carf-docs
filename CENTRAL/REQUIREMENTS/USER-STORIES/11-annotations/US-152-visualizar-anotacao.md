---
modules: [GEOAPI, GEOWEB, REURBCAD]
epic: compatibility
---

# US-152: Visualizar Anotacao

Como Analista quero ver detalhes de uma anotacao para que possa ler observacao completa visualizar geometria no mapa consultar thread de comentarios verificar anexos e acompanhar historico de alteracoes de status, onde o endpoint implementado em GEOAPI expoe a rota /api/annotations/{id} retornando objeto Annotation detalhado com todas as propriedades geometria comentarios anexos e timeline de eventos, garantindo validacao de permissoes baseada em roles onde usuarios autenticados podem visualizar anotacoes do seu tenant, incluindo tratamento de erro 404 Not Found quando ID da anotacao nao existe e validacao de isolamento multi-tenant impedindo acesso a anotacoes de outros tenants, permitindo que a resposta inclua objeto completo com propriedades id title description category status priority geometry communityId communityName unitId unitCode plotId plotCode blockId blockCode createdBy createdByName createdByEmail assignedTo assignedToName assignedToEmail resolutionNotes resolvedAt resolvedBy subscribers attachments replies createdAt updatedAt, onde a propriedade geometry retorna GeoJSON Point LineString ou Polygon com coordenadas em EPSG:4326 permitindo renderizacao direta em mapa com destaque visual, garantindo rastreabilidade ao requisito funcional RF-133 que especifica visualizacao de anotacoes colaborativas, incluindo relacionamento eager loading com entidades Community Unit Plot Block Users createdBy assignedTo resolvedBy para exibir contexto completo sem requisicoes adicionais, permitindo que o frontend GEOWEB renderize painel lateral com mapa mostrando geometria da anotacao com zoom automatico para enquadrar area de interesse titulo descricao categoria status prioridade timeline de eventos thread de comentarios galeria de anexos e acoes contextuais, onde array replies contem comentarios ordenados cronologicamente com propriedades id userId userName userAvatar content createdAt permitindo visualizacao de discussao completa sobre a anotacao, garantindo que array attachments inclui documentos fotos croquis com propriedades id fileName fileType fileSize thumbnailUrl downloadUrl uploadedBy uploadedAt facilitando acesso rapido a evidencias, incluindo timeline de eventos mostrando quando anotacao foi criada status alterado reatribuida comentada resolvida e reaberta com timestamps usuarios responsaveis e comentarios explicativos, permitindo visualizacao de elementos cadastrais relacionados onde se anotacao esta vinculada a unidade plot ou block sistema exibe link clicavel para navegar ate detalhes do elemento e visualizar no mapa, onde campo subscribers lista usuarios que estao acompanhando a anotacao recebendo notificacoes de atualizacoes com opcao de adicionar ou remover subscription, garantindo que apenas usuario assignedTo pode editar campos resolutionNotes e alterar status para RESOLVED mas qualquer usuario autenticado pode adicionar comentarios e anexos, incluindo botoes de acao contextuais conforme permissoes do usuario incluindo editar reatribuir resolver reabrir excluir comentar anexar arquivo e compartilhar link, permitindo compartilhamento de link direto da anotacao que ao ser acessado por outro usuario exibe mapa centralizado na anotacao com painel de detalhes aberto facilitando colaboracao, onde a implementacao em GEOAPI utiliza DTO AnnotationDetailDto com campos computados incluindo repliesCount attachmentsCount isSubscribed indicando se usuario atual esta inscrito e canResolve indicando se usuario tem permissao para resolver, garantindo cache de detalhes de anotacao com invalidacao quando comentarios anexos ou status forem atualizados, incluindo suporte a menções em comentarios onde usuario pode mencionar outro usuario usando @username acionando notificacao automatica ao usuario mencionado, permitindo export de detalhes em formato PDF gerando relatorio com mapa de localizacao dados da anotacao thread completa de comentarios lista de anexos e assinaturas digitais dos usuarios envolvidos, onde testes unitarios validam calculo de campos computados serializacao de geometria e logica de permissoes com datasets mock, garantindo testes de integracao que verificam recuperacao completa de anotacao com relacionamentos eager loading replies attachments subscribers e validacao de isolamento multi-tenant.

---

**Ultima atualizacao:** 2025-12-30
**Última atualização:** 2026-01-15
**Status do arquivo**: Pronto
