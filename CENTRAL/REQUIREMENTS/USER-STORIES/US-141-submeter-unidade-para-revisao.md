---
modules: [GEOAPI, GEOWEB]
epic: compatibility
---

# US-141: Submeter Unidade para Revisao

Como Analista quero submeter unidade cadastrada para aprovacao para que possa enviar unidade para validacao do gerente apos completar cadastro com todas as informacoes e documentos obrigatorios, onde o endpoint implementado em GEOAPI expoe a rota /api/units/{id}/submit-review com metodo POST para solicitar revisao da unidade habitacional, garantindo validacao de permissoes baseada em roles onde usuarios com role Analyst ou superior podem submeter unidades para revisao, incluindo tratamento de erros 404 Not Found quando ID da unidade nao existe, 403 Forbidden quando usuario nao possui permissao e 422 Unprocessable Entity quando unidade nao atende criterios minimos para submissao, permitindo que operacao execute transicao automatica de status de DRAFT para PENDING acionando workflow de aprovacao gerencial, onde validacao pre-submissao verifica completude cadastral incluindo presenca de geometria valida titular vinculado endereco completo tipo de ocupacao area minima e documentos obrigatorios configurados por comunidade, garantindo rastreabilidade ao requisito funcional RF-069 que especifica workflow de aprovacao de cadastro, incluindo validacao de integridade geometrica onde sistema verifica que poligono da unidade nao possui auto-intersecoes esta completamente contido dentro do lote ou quadra pai e nao se sobrepoe significativamente a outras unidades da mesma comunidade, permitindo payload JSON opcional com propriedades comment comentario do analista direcionado ao gerente revisor, priority nivel de prioridade NORMAL URGENT para casos que requerem analise acelerada e reviewers array de IDs de gerentes especificos aos quais solicitar revisao, onde submissao dispara evento de dominio UnitSubmittedForReview publicado no message bus acionando notificacao automatica aos gerentes com role Manager ou usuarios especificados em reviewers, garantindo registro de auditoria detalhado capturando usuario responsavel timestamp comentario e snapshot do estado da unidade no momento da submissao para permitir comparacao posterior, incluindo validacao de limite de submissoes onde analista nao pode ter mais de X unidades pendentes simultaneamente configuravel por tenant para garantir qualidade e evitar sobrecarga do processo de revisao, permitindo que o frontend GEOWEB exiba wizard de pre-submissao com checklist interativo validando cada criterio obrigatorio incluindo geometria titular documentos e exibindo icones de sucesso ou erro para cada item, onde a implementacao em GEOAPI utiliza Command pattern para encapsular logica de submissao e Chain of Responsibility pattern para executar sequencia de validacoes pre-submissao de forma ordenada e falhavel, garantindo que se validacao de geometria demorar mais de 5 segundos operacao retorna 202 Accepted com Location header para polling do resultado evitando timeout da requisicao HTTP, incluindo metricas de qualidade onde sistema rastreia taxa de aprovacao por analista tempo medio de revisao e principais motivos de rejeicao para identificar gaps de treinamento e melhorias de processo, onde notificacao aos gerentes inclui link direto para painel de revisao da unidade com mapa de localizacao resumo cadastral lista de documentos anexados e botoes para aprovar rejeitar ou solicitar complementacao, garantindo que analista recebe notificacao quando gerente inicia revisao de sua submissao permitindo acompanhamento em tempo real do status da analise, onde testes unitarios validam cada validacao pre-submissao isoladamente com datasets mock simulando casos de sucesso e diferentes tipos de falha, garantindo testes de integracao que verificam fluxo completo de submissao incluindo alteracao de status publicacao de evento registro de auditoria e envio de notificacoes utilizando infraestrutura real de messaging email e banco de dados PostgreSQL.

---

**Ultima atualizacao:** 2025-12-30
