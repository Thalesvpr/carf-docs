---
modules: [GEOAPI, GEOWEB, REURBCAD]
epic: security
---

# US-119: Gerenciar Serviços WMS/WMTS

Como administrador de tenant necessitando integrar dados geoespaciais externos, quero cadastrar e listar serviços geoespaciais WMS (Web Map Service) e WMTS (Web Map Tile Service) para que integrar camadas cartográficas externas no mapa interativo seja possível, enriquecendo visualização com bases de referência como imagens de satélite, mapas topográficos, ortofotos, zoneamento urbano, ou dados cadastrais municipais complementares. A funcionalidade deve permitir cadastramento de novo geoserviço através de formulário capturando informações essenciais incluindo nome descritivo para identificação interna, tipo de serviço (WMS ou WMTS), URL base do endpoint GetCapabilities para descoberta automática de camadas disponíveis, e credenciais de autenticação quando serviço protegido requer usuário e senha para acesso. O sistema deve executar validação automática ao cadastrar geoserviço fazendo requisição de teste ao endpoint fornecido verificando acessibilidade do servidor, compatibilidade de versão do protocolo (WMS 1.1.1, 1.3.0 ou WMTS 1.0.0), parsing do documento Capabilities XML para extrair metadados incluindo sistema de coordenadas suportado (EPSG), extensão geográfica (bounding box), e lista de camadas disponíveis com títulos e abstracts descritivos. A listagem de geoserviços deve apresentar todos os serviços cadastrados no tenant incluindo identificação, tipo, URL, status de conectividade (ONLINE verificado recentemente, OFFLINE com falha na última checagem, UNCHECKED ainda não validado), data de cadastro, e quantidade de camadas descobertas disponíveis para uso. Interface deve permitir edição de geoserviços existentes atualizando URL quando servidor migra de endereço, credenciais quando há rotação de senhas, ou nome descritivo para melhor organização, e remoção de geoserviços quando não mais necessários verificando dependências (camadas em uso em mapas ativos) antes de permitir exclusão. Operação de refresh manual deve estar disponível para forçar nova requisição GetCapabilities atualizando metadados e lista de camadas quando serviço externo adiciona novos layers ou modifica configurações. Os critérios de aceitação incluem endpoint implementado aceitando POST /api/geoservices para criar com validação automática e GET /api/geoservices para listar com filtros por tipo e status, validação rigorosa de permissões garantindo que apenas administradores possam gerenciar geoserviços do tenant, tratamento adequado de erros incluindo URL inválida, timeout de conexão, credenciais incorretas ou parsing de Capabilities falhou, documentação OpenAPI descrevendo schema de geoserviço, processo de validação automática e estrutura de metadados extraídos, e testes unitários e de integração validando cadastro, validação automática, listagem, atualização e remoção incluindo mock de servidores WMS/WMTS para testes isolados. Esta User Story está relacionada ao RF-212 e é implementada através dos endpoints POST/GET /api/geoservices no backend GEOAPI com client HTTP para requisições GetCapabilities e parser XML, e interface de gestão no frontend GEOWEB com formulário de cadastro e tabela de geoserviços, pertencendo ao Epic 12: Integrações. O status atual é proposed, com endpoint existente mas documentação formal criada posteriormente.

---

**Última atualização:** 2025-12-30
**Status do arquivo**: Review
