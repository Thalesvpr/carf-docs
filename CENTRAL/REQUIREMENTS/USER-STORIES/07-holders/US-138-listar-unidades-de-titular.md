---
modules: [GEOAPI, GEOWEB, REURBCAD]
epic: performance
---

# US-138: Listar Unidades de Titular

Como Analista quero ver todas as unidades de um titular para que possa identificar posses multiplas ou irregularidades como ocupacao simultanea de mais unidades do que permitido por regras de regularizacao fundiaria, onde o endpoint implementado em GEOAPI expoe a rota /api/holders/{id}/units retornando lista paginada de unidades habitacionais vinculadas ao titular especificado, garantindo validacao de permissoes baseada em roles onde usuarios com role Analyst ou superior podem listar unidades de titulares do seu tenant, incluindo tratamento de erro 404 Not Found quando ID do titular nao existe e validacao de isolamento multi-tenant impedindo acesso a unidades de titulares de outros tenants, permitindo filtragem da listagem atraves de query parameters incluindo status para filtrar por DRAFT PENDING APPROVED, communityId para filtrar unidades de uma comunidade especifica, occupationType para filtrar por tipo de ocupacao RESIDENTIAL COMMERCIAL MIXED, search para busca textual em codigo ou endereco e dateRange para filtrar por periodo de vinculacao, onde a resposta inclui paginacao com page size totalCount hasNextPage hasPreviousPage e array items contendo objetos Unit com propriedades id code address area builtArea status occupationType plotCode blockCode communityName linkDate linkType isMainResidence createdAt updatedAt, garantindo rastreabilidade ao requisito funcional RF-091 que especifica gerenciamento de vinculacao entre titulares e unidades, incluindo relacionamento com entidades Plot Block e Community para exibir localizacao completa da unidade sem necessidade de requisicoes adicionais, permitindo que o frontend GEOWEB exiba tabela paginada com destaque visual para casos de multiplas posses incluindo badge de alerta quando titular possui mais de uma unidade na mesma comunidade, onde campo linkType indica natureza do vinculo incluindo OWNER POSSESSOR TENANT HEIR CO_OWNER permitindo analise de diferentes tipos de relacao juridica entre titular e unidade, garantindo que campo isMainResidence indica se aquela unidade e declarada como residencia principal do titular facilitando identificacao de casos de especulacao imobiliaria, incluindo metricas agregadas retornadas em response headers como totalUnits totalArea totalBuiltArea communitiesCount indicando quantidade de comunidades diferentes onde titular possui unidades, permitindo ordenacao por multiplos campos atraves de parametro sortBy aceitando valores como linkDate desc, area asc, communityName asc facilitando analise temporal e espacial das posses, onde a implementacao em GEOAPI utiliza specification pattern para construir queries dinamicas e repository pattern para abstrair acesso a dados garantindo testabilidade e manutencao, garantindo deteccao automatica de irregularidades onde sistema identifica titulares com mais de X unidades configuravel por comunidade e marca com flag requiresReview para analise de equipe de regularizacao, incluindo export da listagem em formatos CSV Excel e PDF para geracao de relatorios de titularidade e documentacao de processos de regularizacao fundiaria, onde testes unitarios validam logica de filtragem paginacao calculo de metricas agregadas e deteccao de irregularidades com datasets mock, garantindo testes de integracao que verificam recuperacao correta de unidades por titular com relacionamentos eager loading validacao de isolamento multi-tenant e performance de queries com multiplos joins, incluindo alertas visuais no frontend quando titular possui unidades em diferentes municipios ou estados indicando possivel inconsistencia cadastral que requer investigacao.

---

**Ultima atualizacao:** 2025-12-30
