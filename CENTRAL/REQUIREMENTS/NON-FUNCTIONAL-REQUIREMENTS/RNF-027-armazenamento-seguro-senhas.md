---
modules: [GEOAPI, GEOWEB, REURBCAD, GEOGIS]
epic: security
---

# RNF-027: Armazenamento Seguro de Senhas

O sistema de autenticação Keycloak utilizado pelo GEOMAP5 deve implementar armazenamento seguro de senhas de usuários através de algoritmos de hashing modernos e resistentes a ataques de força bruta, garantindo que mesmo em caso de comprometimento do banco de dados de credenciais as senhas originais não possam ser recuperadas. O algoritmo bcrypt deve ser utilizado como mecanismo de hashing de senhas com fator de custo (work factor) configurado em no mínimo 12 rounds, criando um processo computacionalmente custoso que torna ataques de força bruta e rainbow tables economicamente inviáveis, onde cada aumento no fator de custo dobra o tempo necessário para processar cada tentativa de senha. O processo de salting automático do bcrypt deve garantir que mesmo senhas idênticas de diferentes usuários resultem em hashes completamente diferentes armazenados no banco de dados, eliminando a possibilidade de identificar usuários com senhas comuns ou reutilizadas através de análise de hashes duplicados. A política de senha forte deve ser configurada no Keycloak exigindo que senhas tenham no mínimo 8 caracteres de comprimento, incluindo combinação de letras maiúsculas e minúsculas, pelo menos um dígito numérico e um caractere especial de pontuação ou símbolo, criando espaço de senha grande o suficiente para resistir a ataques de dicionário e força bruta. Validações adicionais devem prevenir uso de senhas muito comuns (como "Password123!"), senhas que sejam variações simples do nome de usuário, e devem encorajar ou exigir rotação periódica de senhas para contas administrativas. O sistema não deve implementar limite máximo de comprimento de senha artificialmente baixo, permitindo que usuários utilizem passphrases longas que são tanto mais seguras quanto mais fáceis de memorizar do que senhas curtas e complexas. Funcionalidade de recuperação de senha deve ser implementada através de tokens de tempo limitado enviados por email, nunca revelando ou transmitindo a senha atual, mas permitindo definição de nova senha após validação do token. Múltiplas tentativas de login falhadas devem resultar em bloqueio temporário da conta ou CAPTCHA para prevenir enumeração de senhas, com logs de auditoria registrando essas tentativas para análise de segurança. Este requisito é Must-have pois credenciais são o ponto de entrada primário do sistema, e qualquer fraqueza em seu armazenamento ou políticas pode comprometer toda a segurança do GEOMAP5 independentemente de outras proteções implementadas.
