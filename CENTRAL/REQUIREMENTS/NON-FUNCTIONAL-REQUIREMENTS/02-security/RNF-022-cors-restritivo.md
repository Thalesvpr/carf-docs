---
modules: [GEOAPI, REURBCAD]
epic: security
---

# RNF-022: CORS Restritivo

O módulo GEOAPI deve implementar políticas de CORS (Cross-Origin Resource Sharing) altamente restritivas que permitam requisições apenas de origens explicitamente autorizadas, prevenindo que websites maliciosos realizem chamadas à API em nome de usuários autenticados através de seus navegadores. A configuração deve manter uma whitelist de origens permitidas, incluindo os domínios oficiais do GEOWEB em ambientes de desenvolvimento, staging e produção, além de aplicações mobile através do protocolo capacitor:// para o REURBCAD, sendo que qualquer requisição de origem não listada deve ser bloqueada antes mesmo de alcançar os endpoints da API. O header Access-Control-Allow-Credentials deve ser habilitado apenas para origens confiáveis que necessitam enviar cookies ou tokens de autenticação, enquanto origens menos confiáveis devem ser restritas a requisições sem credenciais. A lista de métodos HTTP permitidos deve ser limitada aos estritamente necessários para cada tipo de recurso, evitando exposição desnecessária de operações como DELETE ou PATCH para origens que não necessitam dessas funcionalidades. Os headers permitidos nas requisições (Access-Control-Allow-Headers) devem incluir apenas aqueles utilizados pela aplicação, como Authorization, Content-Type e headers customizados específicos do sistema, rejeitando headers arbitrários que possam ser explorados em ataques. A configuração de CORS deve ser centralizável através de middleware no pipeline de requisições do ASP.NET Core, permitindo manutenção consistente e auditável das políticas de segurança, com possibilidade de configuração diferenciada por ambiente através de variáveis de ambiente ou arquivos de configuração externos. Requisições preflight (OPTIONS) devem ser tratadas eficientemente com cache apropriado através do header Access-Control-Max-Age, reduzindo overhead de rede sem comprometer segurança. Este requisito é Must-have pois CORS mal configurado é uma das vulnerabilidades mais comuns em APIs modernas, permitindo ataques como CSRF (Cross-Site Request Forgery) e exfiltração de dados sensíveis através de websites maliciosos que exploram sessões autenticadas de usuários.
**Última atualização:** 2026-01-15
**Status do arquivo**: Pronto
