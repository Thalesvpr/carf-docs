---
modules: [GEOAPI]
epic: security
---

# RNF-035: Monitoramento de Segurança

O sistema GEOMAP5 deve implementar monitoramento proativo de eventos de segurança com alertas automáticos para padrões suspeitos ou indicadores de comprometimento, permitindo resposta rápida a incidentes antes que danos significativos ocorram. O sistema deve detectar e alertar sobre múltiplas tentativas de login falhadas originadas do mesmo endereço IP, onde 5 ou mais falhas de autenticação em período de 10 minutos indica provável ataque de força bruta contra credenciais, gerando alerta para equipe de segurança com detalhes incluindo IP de origem, usuários alvo das tentativas e timestamps, permitindo bloqueio manual ou automático do IP se o padrão persistir. Acessos originados de endereços IP em listas de reputação negativa conhecidas (blacklists públicas de IPs maliciosos) ou de países/regiões geograficamente incompatíveis com a base de usuários esperada do sistema devem gerar alertas para investigação, onde por exemplo acessos da Ásia ou Leste Europeu seriam suspeitos para sistema predominantemente usado no Brasil. Mudanças em permissões críticas ou roles de usuários, especialmente elevações para administrador ou concessão de permissões sensíveis como units.delete ou acesso a logs de auditoria, devem gerar notificações imediatas para administradores de segurança, incluindo quem realizou a mudança, qual usuário foi afetado e timestamp, permitindo validar que mudanças foram autorizadas ou reverter rapidamente se não autorizado. Padrões anômalos de acesso a dados como volume incomumente alto de consultas a dados pessoais, download massivo de registros, ou acessos a recursos de tenants com os quais o usuário normalmente não interage devem ser flagged para análise, potencialmente indicando conta comprometida ou insider malicioso exfiltrando dados. Erros de autenticação e autorização, especialmente tentativas de acesso cross-tenant bloqueadas por RLS ou requisições com tokens JWT inválidos ou expirados em volume anormal, podem indicar tentativas de ataque ou reconhecimento da superfície de ataque. A implementação deve utilizar agregação de logs em sistema centralizado como ELK Stack (Elasticsearch, Logstash, Kibana) ou Loki+Grafana, onde regras de correlação e queries podem identificar padrões suspeitos em tempo real através de múltiplos streams de eventos. Integração com sistemas de alerting como PagerDuty, Opsgenie ou notificações via Slack/Teams deve entregar alertas prontamente à equipe responsável através de canais com alta probabilidade de serem vistos e respondidos mesmo fora de horário comercial. Dashboards de segurança devem visualizar métricas como tentativas de login falhadas por hora, distribuição geográfica de acessos, top IPs por volume de requisições, e tendências de erros de autorização, permitindo monitoramento contínuo e identificação de anomalias através de inspeção visual. Runbooks documentados devem guiar equipe de operações em como responder a cada tipo de alerta, incluindo passos de investigação, critérios de escalação, e ações corretivas comuns como bloqueio de IP, revogação de tokens ou desabilitação de conta comprometida. Este requisito é classificado como Should-have pois, embora monitoramento proativo seja importante para segurança operacional contínua, controles preventivos implementados através de outros RNFs já fornecem proteção substancial, tornando monitoramento uma camada adicional de defesa e resposta recomendada mas não absolutamente crítica para lançamento inicial.
**Última atualização:** 2026-01-15
**Status do arquivo**: Pronto
