---
modules: [GEOAPI, GEOWEB]
epic: security
---

# RNF-028: Proteção de API Keys

As API keys utilizadas para autenticação de integrações server-to-server e serviços automatizados no sistema GEOAPI devem ser gerenciadas com rigor equivalente a senhas de usuário, implementando hashing forte, escopo limitado de permissões e mecanismos de revogação imediata para minimizar riscos de comprometimento. Quando uma API key é gerada pelo sistema, ela deve ser apresentada ao usuário exatamente uma vez em formato legível, sendo subsequentemente armazenada no banco de dados apenas como hash bcrypt com fator de custo mínimo de 12, garantindo que nem mesmo administradores do sistema possam recuperar keys originais de clientes, forçando geração de novas keys em caso de perda. Cada API key deve ter escopo claramente definido de permissões, limitando quais recursos podem ser acessados e quais operações podem ser realizadas, seguindo princípio de privilégio mínimo onde keys devem ter apenas permissões estritamente necessárias para sua função pretendida, evitando que comprometimento de uma key exponha todo o sistema. Mecanismos de expiração configurável devem permitir que administrators definam tempo de vida para cada key, após o qual ela automaticamente se torna inválida exigindo rotação, com suporte a policies organizacionais que podem impor expiração máxima de 90 dias ou 1 ano dependendo do nível de segurança requerido. O sistema deve fornecer interface administrativa para revogação imediata de API keys, permitindo que em caso de suspeita de comprometimento ou quando um serviço é descontinuado, a key possa ser invalidada instantaneamente sem necessidade de restart de serviços ou modificações de banco de dados. Logs de auditoria devem registrar cada uso de API key incluindo timestamp, operação realizada, recursos acessados e endereço IP de origem, permitindo detecção de uso anômalo como requisições de localizações geográficas inesperadas ou padrões de acesso incompatíveis com o propósito declarado da key. A geração de API keys deve utilizar gerador de números aleatórios criptograficamente seguro (CSPRNG) para produzir keys de comprimento suficiente (mínimo 32 caracteres) com alta entropia, tornando impossível adivinhar ou prever keys válidas através de força bruta. Metadados associados a cada key, como descrição de propósito, serviço ou aplicação que a utiliza, data de criação e último uso, devem ser mantidos para facilitar auditoria e housekeeping periódico de keys obsoletas. Este requisito é Must-have pois API keys são credenciais de longa duração que frequentemente têm permissões amplas, tornando seu comprometimento potencialmente mais danoso que credenciais de usuário individual, exigindo proteções rigorosas equivalentes.
**Última atualização:** 2026-01-15
**Status do arquivo**: Pronto
