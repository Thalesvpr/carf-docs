---
modules: [GEOAPI, GEOWEB, REURBCAD]
epic: security
---

# RNF-017: Expiração de Tokens

Os access tokens emitidos pelo sistema de autenticação devem expirar em 15 minutos e os refresh tokens devem expirar em 7 dias, estabelecendo um equilíbrio cuidadoso entre segurança e experiência do usuário através de janelas temporais que minimizam exposição em caso de comprometimento enquanto mantém sessões ativas por períodos razoáveis. Este requisito aplica-se aos módulos Keycloak e GEOAPI, onde o Keycloak é responsável por emitir tokens com os TTLs configurados e o GEOAPI valida e renova tokens conforme necessário. Os critérios de aceitação especificam que o TTL (Time To Live) de access tokens deve ser configurado para exatamente 15 minutos, sendo este um período curto suficiente para limitar a janela de oportunidade caso um token seja interceptado ou roubado, pois após 15 minutos o token torna-se inválido e não pode mais ser utilizado para acessar recursos protegidos, forçando renovação através do refresh token. O TTL de refresh tokens deve ser configurado para 7 dias, permitindo que usuários mantenham sessões ativas por uma semana sem necessidade de fornecer credenciais novamente, sendo este um período que balanceia conveniência para usuários que acessam o sistema regularmente com segurança adequada, onde sessões muito longas aumentam riscos especialmente em dispositivos compartilhados ou comprometidos. Adicionalmente, o sistema deve implementar renovação automática de access tokens utilizando refresh tokens válidos, onde a aplicação cliente detecta quando um access token está próximo da expiração ou já expirou e automaticamente utiliza o refresh token para obter um novo access token sem interromper o fluxo de trabalho do usuário ou requerer nova autenticação, proporcionando experiência contínua apesar das expirações frequentes. Este requisito é classificado como Must-have porque a gestão adequada de expiração de tokens é fundamental para segurança do sistema, onde tokens de longa duração representam riscos significativos de segurança pois ampliam a janela de exposição em casos de vazamento ou comprometimento, enquanto a renovação automática é essencial para usabilidade evitando que usuários sejam constantemente interrompidos para re-autenticação. A implementação deve considerar configuração precisa dos TTLs no Keycloak através das configurações de realm e client, implementação de lógica de renovação automática nos clientes que detecta expiração através da análise do campo exp do JWT ou através de respostas 401 Unauthorized da API, tratamento adequado de casos onde refresh token também expirou redirecionando usuário para tela de login, implementação de sliding sessions onde a cada renovação o refresh token também é renovado estendendo a sessão enquanto usuário está ativo, e potencialmente implementar absolute session timeout que encerra sessão após período fixo independente de atividade para contextos de alta segurança.
**Última atualização:** 2026-01-15
**Status do arquivo**: Pronto
