---
modules: [GEOAPI, GEOWEB, REURBCAD, GEOGIS]
epic: reliability
---

# RNF-037: Recuperação de Falhas

O sistema GEOAPI deve implementar mecanismos robustos de recuperação automática para falhas transientes, garantindo alta disponibilidade e resiliência operacional sem necessidade de intervenção manual. A recuperação deve abranger três camadas principais de proteção, onde o restart automático de containers é gerenciado pelo orquestrador Kubernetes através de health checks e readiness probes, detectando quando um container se torna não responsivo e reiniciando-o automaticamente para restaurar a operação normal. O circuit breaker deve ser implementado para chamadas a serviços externos, incluindo bancos de dados, APIs de terceiros e serviços de storage, utilizando padrões como Polly no contexto .NET para abrir o circuito após um número configurável de falhas consecutivas, permitindo que o sistema degrade graciosamente ao invés de propagar erros em cascata, com um período de timeout antes de tentar novamente a conexão para verificar se o serviço externo se recuperou. A estratégia de retry com exponential backoff deve ser aplicada a operações que podem falhar temporariamente, como chamadas HTTP, operações de banco de dados e uploads de arquivos, com intervalos progressivamente maiores entre tentativas para evitar sobrecarregar sistemas já estressados, utilizando jitter para distribuir as tentativas de retry e evitar thundering herd problems. Os critérios de aceitação incluem a verificação de que containers com falhas são automaticamente reiniciados pelo Kubernetes dentro de 30 segundos, que o circuit breaker interrompe chamadas a serviços externos após 5 falhas consecutivas e aguarda 60 segundos antes de tentar novamente, que operações com retry implementam backoff exponencial começando em 100ms e dobrando até um máximo de 30 segundos, que logs estruturados registram todas as tentativas de recuperação com contexto adequado para debugging, e que métricas de falhas e recuperações são expostas para monitoramento via Prometheus. Este requisito é classificado como must-have por ser essencial para a confiabilidade do sistema em ambientes de produção, permitindo que o GEOAPI mantenha operação contínua mesmo diante de falhas temporárias de infraestrutura ou dependências externas, minimizando o impacto de problemas transientes na experiência do usuário e reduzindo a necessidade de intervenção manual da equipe de operações.
