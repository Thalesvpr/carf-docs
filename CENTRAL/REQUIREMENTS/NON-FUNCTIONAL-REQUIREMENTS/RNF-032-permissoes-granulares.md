---
modules: [GEOAPI, GEOWEB]
epic: scalability
---

# RNF-032: Permissões Granulares

O sistema GEOAPI deve implementar sistema de controle de acesso baseado em roles (RBAC - Role-Based Access Control) com permissões granulares definidas no nível de recurso e operação, permitindo que administradores configurem precisamente quais ações cada tipo de usuário pode realizar sobre cada entidade do sistema. As permissões devem seguir padrão de nomenclatura consistente combinando nome do recurso com tipo de operação, como "units.read" para visualizar unidades habitacionais, "units.write" para criar e editar, "units.delete" para remover, "holders.read" para consultar titulares, "communities.admin" para administração completa de comunidades, criando vocabulário claro e auditável de capacidades. O sistema deve suportar roles predefinidos que agrupam conjuntos coerentes de permissões para personas comuns como "Cadastrador" que pode criar e editar unidades e titulares mas não deletar, "Supervisor" que adiciona capacidades de aprovação e auditoria, "Administrador Municipal" com controle total sobre dados do seu município, e "Administrador de Sistema" com acesso irrestrito incluindo configurações e gerenciamento de usuários. Herança de roles deve ser suportada permitindo que roles complexos sejam construídos a partir de roles mais simples, onde por exemplo "Supervisor" herda todas as permissões de "Cadastrador" e adiciona permissões extras, simplificando gerenciamento e reduzindo redundância de configuração. A avaliação de permissões deve ocorrer tanto no backend GEOAPI, onde cada endpoint verifica se o usuário autenticado possui as permissões necessárias antes de executar a operação rejeitando com HTTP 403 se insuficiente, quanto no frontend GEOWEB/REURBCAD onde botões e menus de ações não permitidas devem ser ocultados ou desabilitados melhorando experiência do usuário, embora a segurança real sempre dependa da validação no backend. Permissões devem ser codificadas no token JWT do usuário como claims, permitindo que o GEOAPI valide acesso de forma stateless sem necessidade de consultar banco de dados de permissões em cada requisição, embora refresh do token seja necessário quando permissões são alteradas. O sistema deve manter separação clara entre permissões de dados (acesso a unidades, titulares, etc.) e permissões administrativas (gerenciar usuários, configurar sistema, visualizar logs de auditoria), garantindo que usuários operacionais não tenham acesso inadvertido a funções sensíveis de administração. Interface administrativa deve permitir visualização e edição de permissões por role e por usuário individual para casos especiais, com logs de auditoria registrando todas as mudanças de permissões incluindo quem fez a alteração, quando e qual a justificativa. Este requisito é Must-have pois controle de acesso adequado é fundamental para segurança em ambientes multi-tenant e multi-usuário, onde diferentes pessoas e organizações têm necessidades legítimas mas limitadas de acesso a dados, exigindo mecanismos robustos para enforcar políticas de menor privilégio.
