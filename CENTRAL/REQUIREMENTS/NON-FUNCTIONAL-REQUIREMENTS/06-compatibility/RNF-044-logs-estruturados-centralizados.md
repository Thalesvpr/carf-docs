---
modules: [REURBCAD]
epic: compatibility
---

# RNF-044: Logs Estruturados

O sistema GEOAPI deve implementar logging estruturado em formato JSON com campos padronizados, permitindo fácil parsing, indexação e consulta através de ferramentas de agregação de logs como ELK Stack (Elasticsearch, Logstash, Kibana), Grafana Loki ou similar, superando as limitações de logs em formato de texto livre que dificultam análises automatizadas e correlação de eventos. O formato JSON deve incluir campos padronizados em todas as mensagens de log, incluindo timestamp em formato ISO 8601 com timezone UTC para consistência, level indicando a severidade (ERROR, WARN, INFO, DEBUG), message contendo a descrição legível do evento, logger ou source identificando o componente que gerou o log, request_id para correlação de todos os logs relacionados a uma mesma requisição HTTP, user_id quando aplicável para rastrear ações de usuários específicos, tenant_id para isolar logs por organização em ambientes multi-tenant, e campos customizados relevantes ao contexto como operation_name, duration_ms, status_code e error_details quando aplicável. Os níveis de log devem ser utilizados consistentemente seguindo convenções claras, onde ERROR é reservado para erros que requerem atenção imediata e impactam funcionalidade (exceptions não tratadas, falhas de integridade de dados, impossibilidade de completar operações críticas), WARN para situações anormais que não impedem operação mas merecem atenção (retry attempts, fallback para valores default, uso de APIs deprecated, limites de rate approaching), INFO para eventos importantes do ciclo de vida da aplicação e operações de negócio (application started, user logged in, order created, payment processed), e DEBUG para informações detalhadas úteis durante desenvolvimento e troubleshooting mas muito verbosas para produção (valores de variáveis, queries SQL executadas, detalhes de processamento interno). A correlação via request ID é fundamental para debugging de requisições distribuídas e deve funcionar gerando um UUID único para cada requisição HTTP recebida, injetando este request_id em todos os logs emitidos durante o processamento desta requisição incluindo logs de controllers, services, repositories e chamadas a serviços externos, propagando o request_id para downstream services através de headers HTTP como X-Request-ID, e permitindo que através de uma simples busca por request_id específico seja possível reconstruir toda a execução de uma requisição através de múltiplos componentes e serviços. A agregação de logs deve ser implementada utilizando agentes como Fluent Bit ou Filebeat que coletam logs dos containers, parsem o JSON e enviem para sistema centralizado como Elasticsearch, Loki ou CloudWatch Logs, onde podem ser indexados, consultados através de query languages poderosas, visualizados em dashboards e usados para criar alertas baseados em padrões ou frequência de eventos específicos. Os critérios de aceitação incluem a verificação de que todos os logs são emitidos em formato JSON válido com campos padronizados (timestamp, level, message, logger, request_id), que os quatro níveis de log (ERROR, WARN, INFO, DEBUG) são utilizados consistentemente seguindo guidelines documentadas, que request_id é gerado para cada requisição HTTP e incluído em todos os logs relacionados permitindo correlação completa, que logs são agregados em sistema centralizado (ELK, Loki ou similar) com retenção de pelo menos 30 dias, e que é possível realizar buscas eficientes por campos específicos como user_id, tenant_id, error_type ou qualquer campo custom em menos de 5 segundos para consultas sobre logs do último dia. Este requisito é should-have por melhorar significativamente a capacidade de troubleshooting e observabilidade em produção, especialmente em arquiteturas distribuídas onde rastrear o fluxo de uma requisição através de múltiplos serviços seria impossível sem logging estruturado e correlação adequada, embora adicione overhead de configuração inicial e custos de storage para retenção de grandes volumes de logs.
**Última atualização:** 2026-01-15
**Status do arquivo**: Review
