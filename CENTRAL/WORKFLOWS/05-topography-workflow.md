# Topography Workflow

Workflow de levantamento topográfico profissional executado por topógrafo licenciado (Surveyor com registro CREA válido) utilizando receptor GNSS de precisão para coletar SurveyPoints de perímetro de propriedades com acurácia horizontal inferior a 5 centímetros através de pós-processamento diferencial usando dados de estações de referência RBMC da rede IBGE gerando documentação técnica conforme normas NBR brasileiras incluindo DescriptiveMemorial e LegitimationPlan necessários para registro de imóvel em cartório formalizando regularização fundiária. Fluxo inicia quando topógrafo é designado para Community ou conjunto específico de Units que requerem levantamento topográfico profissional (tipicamente Units em processo de legitimação fundiária ou áreas com requisitos legais de precisão), topógrafo acessa sistema via interface web ou aplicativo mobile visualizando lista de Units atribuídas com informações básicas (endereço código geometria aproximada coletada em campo status), planeja roteiro de visitas otimizando deslocamento geográfico e verificando acessibilidade de cada propriedade, identifica estação RBMC mais próxima da Community consultando catálogo de RbmcStations disponíveis no sistema ou diretamente em site do IBGE, seleciona RbmcStation adequada baseado em distância (idealmente <30km da área de trabalho) e disponibilidade de dados RINEX no período de coleta planejado, e baixa arquivos de observações RINEX da estação RBMC para período estimado de trabalho armazenando localmente para processamento posterior. Durante coleta em campo topógrafo desloca-se até propriedade levando receptor GNSS profissional (double-frequency multi-constellation) e equipamentos auxiliares (tripé bastão antena externa bateria reserva), posiciona receptor sobre vértice de perímetro da propriedade garantindo visibilidade desobstruída do céu para recepção de sinais de satélites GNSS, configura receptor para modo de coleta estático ou cinemático dependendo de requisitos de precisão e tempo disponível onde estático requer 15-30 minutos por ponto oferecendo máxima precisão enquanto cinemático permite coleta contínua com precisão ligeiramente reduzida, inicia gravação de observações GNSS raw data capturando pseudoranges phase measurements SNR e metadados de satélites visíveis em formato RINEX ou proprietário do fabricante, aguarda tempo mínimo de ocupação garantindo coleta de dados suficientes para processamento diferencial de qualidade, move receptor para próximo vértice de perímetro repetindo processo até completar polígono fechado retornando ao ponto inicial para verificação de fechamento, cria SurveyPoint no sistema para cada vértice coletado registrando point_type (MARCO se monumento permanente foi instalado PIQUETE se estaca temporária NATURAL se feature natural como árvore ou rocha foi usado), point_number sequencial (V1 V2 V3 etc), coordenadas aproximadas obtidas de display do receptor (acurácia métrica sem processamento), h_accuracy e v_accuracy estimados baseados em estatísticas de receptor, collection_timestamp preciso de início de observação, equipment especificando marca e modelo de receptor usado, status inicial COLLECTED indicando que ponto foi coletado mas não processado, e raw_data_path referenciando arquivo RINEX ou binário armazenado em sistema de arquivos para processamento posterior. Para monumentos permanentes topógrafo cria Monograph documentando marco instalado capturando fotos panorâmicas nas quatro direções cardeais (norte sul leste oeste) mostrando contexto ao redor do marco, foto closeup do marco mostrando detalhes de construção (concreto com pino metálico chapa de identificação), sketch desenhando croqui manual mostrando distâncias e referências a features permanentes próximas (quina de muro árvore grande poste de luz) facilitando relocação futura do marco, description textual detalhando localização exata tipo de monumento materiais usados e condições de acesso, access_instructions orientando como chegar ao marco desde ponto de referência conhecido, datum e coordinate_system especificando sistema geodésico usado (SIRGAS 2000 UTM zone XX), e vinculando Monograph a SurveyPoint via survey_point_id estabelecendo relação 1:1. Após concluir coleta em campo topógrafo retorna a escritório iniciando processamento diferencial de dados GPS, organiza arquivos de observações RINEX coletados em campo e arquivos RINEX da RbmcStation correspondente ao mesmo período temporal, carrega dados em software de pós-processamento GPS diferencial (não mencionar marca específica) importando observações de rover (receptor móvel) e base (estação RBMC fixa com coordenadas conhecidas de alta precisão), configura parâmetros de processamento especificando datum SIRGAS 2000 modelo de antena usado correções atmosféricas (ionosfera troposfera) e estratégia de resolução de ambiguidades de fase, executa processamento diferencial onde software calcula vetores baseline entre estação RBMC e cada posição ocupada pelo rover resolvendo ambiguidades inteiras de portadora de fase e aplicando correções diferenciais, obtém coordenadas processadas de cada SurveyPoint com precisão horizontal tipicamente entre 1-5cm e vertical entre 2-10cm dependendo de distância à base tempo de ocupação geometria de satélites e condições atmosféricas, valida qualidade de solução verificando estatísticas de processamento (RMS residuals número de satélites usados PDOP ratio de ambiguidades fixadas) garantindo que precisão atende requisitos do projeto, cria SurveyProcessing entity no sistema documentando job de processamento vinculando surveyor_id RbmcStation usada raw_data_path de arquivos de entrada processed_data_path de arquivos de saída processing_software e versão utilizada processing_date h_precision_cm e v_precision_cm alcançados status SUCCESS ou FAILED e report_path referenciando relatório técnico gerado por software, atualiza SurveyPoints com coordenadas processadas latitude longitude altitude de alta precisão substituindo valores aproximados coletados em campo, atualiza h_accuracy e v_accuracy com valores reais de precisão obtidos de processamento, altera status de SurveyPoints para PROCESSED indicando que coordenadas finais estão disponíveis, e valida fechamento de polígono verificando que erro de fechamento (diferença entre coordenada processada do último ponto e coordenada do ponto inicial) está dentro de tolerância aceitável (tipicamente <10cm para levantamentos cadastrais). Com coordenadas processadas de alta precisão topógrafo elabora DescriptiveMemorial conforme norma NBR 13133 e legislação de registros públicos, cria DescriptiveMemorial entity vinculando a Unit ou LegitimationRequest correspondente, gera memorial_text descritivo listando sequencialmente vértices do perímetro com coordenadas UTM ou geográficas azimutes entre vértices consecutivos e distâncias horizontais calculadas de coordenadas processadas, especifica coordinate_system e datum usados (SIRGAS 2000 UTM fuso XXS), calcula e registra area_sqm total do polígono usando coordenadas de alta precisão, calcula perimeter_m somando distâncias entre vértices consecutivos, formata texto conforme padrão aceito por cartórios de registro de imóveis incluindo fórmulas padronizadas e terminologia técnica apropriada, gera documento PDF renderizando memorial_text com formatação adequada cabeçalho identificando topógrafo responsável com nome e número CREA rodapé com data e assinatura digital, faz upload de PDF para sistema de armazenamento de documentos criando Document entity vinculado a DescriptiveMemorial, registra version do memorial (inicialmente 1.0 incrementando se revisões forem necessárias), e marca memorial como pendente de aprovação aguardando revisão por gestor ou cliente. Paralelamente topógrafo elabora LegitimationPlan planta técnica gráfica do imóvel utilizando software CAD (não mencionar marca específica), importa coordenadas processadas de SurveyPoints desenhando polígono de perímetro em escala apropriada (tipicamente 1:500 para áreas urbanas 1:1000 para áreas rurais maiores), adiciona simbologia técnica padrão indicando vértices com numeração monumentos instalados norte geográfico escala gráfica e numérica coordenadas de amarração e informações textuais (área perímetro proprietário endereço), desenha edificações existentes baseado em levantamento de campo ou ortofoto se includes_improvements é true representando casas galpões muros e outras benfeitorias permanentes, adiciona informações de confrontações listando proprietários ou logradouros públicos que fazem limite com imóvel levantado, insere legenda explicando símbolos usados e observações técnicas relevantes, adiciona carimbo profissional com dados do topógrafo (nome CREA número ART - Anotação de Responsabilidade Técnica), exporta planta para formato DWG preservando layers e metadados vetoriais para possível edição futura e também para PDF para visualização e impressão, cria LegitimationPlan entity vinculando a LegitimationRequest especificando surveyor_id file_format (DWG ou PDF ou ambos), scale utilizada, version, includes_improvements baseado em presença de edificações desenhadas, faz upload de arquivos para sistema de armazenamento criando Documents vinculados, e marca planta como pendente de aprovação aguardando revisão. Workflow finaliza quando topógrafo submete conjunto completo de documentação técnica incluindo SurveyPoints processados Monographs de marcos permanentes DescriptiveMemorial e LegitimationPlan para revisão de gestor ou cliente, gestor ou técnico responsável revisa documentação verificando consistência entre memorial e planta validando que área calculada é compatível com área cadastrada inicialmente e conferindo que precisão alcançada atende requisitos legais e técnicos, aprova documentação alterando status de SurveyPoints para APPROVED marcando approved_at em DescriptiveMemorial e LegitimationPlan habilitando uso em processo de legitimação fundiária, e documentação aprovada é anexada a LegitimationRequest permitindo avanço para etapas subsequentes de workflow de regularização incluindo análise jurídica publicação de edital e eventual emissão de LegitimationCertificate.

**Tecnologias envolvidas (implementação específica em PROJECTS/):**
- GNSS: Receptor multi-frequência, software de pós-processamento diferencial
- RBMC: Rede de estações IBGE, arquivos RINEX de observações
- CAD: Software de desenho técnico para elaboração de plantas
- Formatos: RINEX para dados GPS, DWG/PDF para plantas, JSON para API

**Relacionado:**
- Entities: Surveyor, SurveyPoint, RbmcStation, SurveyProcessing, Monograph, DescriptiveMemorial, LegitimationPlan, LegitimationRequest, Unit, Document
- Value Objects: Crea, PointType, PointStatus, GeoPoint
- Workflows: analyst-validation-workflow.md (passo anterior), legitimation-workflow.md (próximo passo)

---

**Última atualização:** 2025-01-05
**Status do arquivo**: Pronto
