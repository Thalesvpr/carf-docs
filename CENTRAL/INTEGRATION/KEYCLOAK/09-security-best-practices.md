# Segurança - Best Practices

Password policy: mínimo 8 caracteres, 1 dígito, 1 maiúscula, 1 minúscula, 1 especial, diferente do username, expiração 90 dias opcional. PKCE obrigatório pra SPAs (code_challenge_method=S256), NUNCA usar Implicit Flow ou Password Grant em produção (deprecated e inseguros). Client secrets: gerar com `openssl rand -base64 32`, rotacionar a cada 90 dias, NUNCA commitar no git, usar secrets manager. Brute force protection: 5 tentativas falhadas = lock temporário 15min, quick login wait 1min entre tentativas, permanent lockout desabilitado (pode reativar). MFA (2FA): habilitar OTP via totpAppGoogleName ou webAuthn pra roles admin e super-admin obrigatório, field-collector e analyst opcional. HTTPS obrigatório: sslRequired=external no realm, KC_HTTP_ENABLED=false em produção, usar TLS 1.2+ apenas, certificados válidos não self-signed. CORS: webOrigins=[+] significa inherit from valid redirectUris, NUNCA usar webOrigins=[\*] em produção. Token em localStorage: OK pra web (XSS risk mitigado por CSP headers), mobile usar secure storage encrypted. JWT validation: backend SEMPRE valida signature usando JWKS public key, exp (expiration), nbf (not before), iss (issuer), aud (audience se configurado). RLS PostgreSQL: última camada de defesa, mesmo com SQL injection impossível acessar outro tenant. Audit logs: habilitar adminEventsEnabled=true e eventsEnabled=true, exportar pra SIEM (Splunk, Elastic), alertar em eventos críticos (failed logins > 10/min, admin action, tenant switch). Rate limiting: 100 req/min por IP no /token endpoint, 1000 req/min por user no GEOAPI, usar Nginx limit_req ou Traefik rateLimit middleware. Secrets: usar Kubernetes Secrets ou AWS Secrets Manager ou Azure Key Vault, NUNCA .env em produção, rotacionar secrets a cada 90 dias, princípio do menor privilégio (cada app só vê seus próprios secrets).

---

**Última atualização:** 2026-01-09
**Status do arquivo**: Pronto
