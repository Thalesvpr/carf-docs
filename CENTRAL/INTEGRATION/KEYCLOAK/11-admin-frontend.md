# Admin Frontend (carf-admin)

Console administrativo Next.js 14 + React 18 + TypeScript + TanStack Query + Tailwind CSS + shadcn/ui usando Keycloak Admin API via @keycloak/keycloak-admin-client npm package. Stack alinhada com GEOWEB (mesma base React 18, TypeScript, TanStack Query, Tailwind) mas Next.js pra SSR/SSG beneficiar SEO e performance do dashboard. Funcionalidades: Dashboard com KPIs (total usuários, tenants, acessos últimas 24h, usuários ativos), Gestão de Tenants (CRUD prefeituras com nome, CNPJ, endereço, logo, status ativo/inativo, data criação), Gestão de Usuários (CRUD com username, email, nome, CPF, roles, tenants autorizados via multi-select, status enabled/disabled, forçar reset senha, view login history), Gestão de Roles (atribuir/remover roles de usuários, visualizar permissões por role, criar custom roles se necessário), Transferência de Usuários (mover usuário de um tenant pra outro atualizando array `tenants`, histórico de transferências com data/motivo/responsável), Auditoria (logs de ações admin com filtros por usuário/tenant/data/tipo-ação, exportar CSV). Integração Keycloak Admin API: `const kcAdmin = new KcAdminClient({ baseUrl, realmName: 'carf' }); await kcAdmin.auth({ username, password, grantType: 'password', clientId: 'admin' }); const users = await kcAdmin.users.find({ realm: 'carf' }); await kcAdmin.users.update({ id: userId }, { attributes: { tenants: ['prefeitura-a', 'prefeitura-b'] } })`. Autenticação: próprio admin usa Keycloak OAuth2 com PKCE, só usuários com role super-admin ou client role manage-tenants podem acessar, session timeout 30min com auto-logout. UI específica REURB: terminologia "Prefeituras" ao invés de "Tenants", formulários com CNPJ validation, dashboard mostra métricas REURB (unidades cadastradas por prefeitura, processos em andamento, certificados emitidos). Deploy: Vercel ou self-hosted Docker, env vars NEXT_PUBLIC_KEYCLOAK_URL, KEYCLOAK_ADMIN_USERNAME, KEYCLOAK_ADMIN_PASSWORD (usar secrets), database opcional pra cache de queries (PostgreSQL ou Redis).

---

**Última atualização:** 2026-01-09
**Status do arquivo**: Review
