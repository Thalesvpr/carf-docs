# VARIÁVEIS DE AMBIENTE

Documentação completa variáveis ambiente por projeto CARF organizadas por componente com descrição tipo formato valores default obrigatoriedade facilitando configuração ambientes desenvolvimento staging produção evitando erros deployment garantindo consistência setup infraestrutura secrets gerenciados externamente Azure Key Vault AWS Secrets Manager nunca commitados repositório seguindo práticas segurança industry standards.

## GEOAPI

DATABASE_URL* (string connection PostgreSQL formato postgres://user:password@host:5432/database exemplo postgres://carf_user:secure_pass@postgres:5432/carf_prod obrigatório todas ambientes define database primário aplicação connection pooling configurado Entity Framework Core default max pool size 100 timeout 30s), KEYCLOAK_URL* (string base URL Keycloak servidor SSO formato http://host:port exemplo http://keycloak:8080 desenvolvimento https://keycloak.carf.example.com produção obrigatório autenticação OAuth2 validação tokens JWT federação identidade), KEYCLOAK_REALM* (string nome realm Keycloak valor carf case-sensitive obrigatório identifica tenant isolation Keycloak configuração separada clients roles permissions), KEYCLOAK_CLIENT_ID* (string identificador client confidencial valor geoapi-backend obrigatório usado obter tokens service account validar tokens incoming requests audience claim), JWT_SECRET* (string chave criptográfica 256-bit base64 formato exemplo dGhpc2lzYXNlY3JldGtleWZvcnNpZ25pbmdqd3R0b2tlbnM= obrigatório assinar tokens refresh customizados complementares Keycloak access tokens rotacionar trimestralmente produção gerar openssl rand -base64 32), REDIS_URL (string connection Redis formato redis://host:port exemplo redis://redis:6379 ou redis://:password@redis:6379 se autenticação opcional default localhost:6379 usado cache distribuído session storage rate limiting pub/sub notifications timeout 5s), RABBITMQ_URL (string connection RabbitMQ formato amqp://user:pass@host:port exemplo amqp://guest:guest@rabbitmq:5672 opcional default localhost:5672 usado mensageria assíncrona domain events background jobs integration events retry exponential backoff), LOG_LEVEL (enum valores debug info warn error default info desenvolvimento debug produção warn controla verbosity logging Serilog structured logging sinks console file Seq opcional monitoramento), ASPNETCORE_ENVIRONMENT* (enum valores Development Staging Production obrigatório controla comportamento runtime exception pages CORS policies HTTPS redirection database migrations aplicadas automático Development manual Staging/Production), ASPNETCORE_URLS (string bind URLs formato http://+:8080 default http://localhost:5000 desenvolvimento http://+:8080 container Docker permite override porta binding), CORS_ORIGINS (string comma-separated lista origins permitidos formato http://localhost:3000,https://geoweb.carf.example.com default * desenvolvimento específico produção security CORS policy validation preflight), ENABLE_SWAGGER (boolean valores true false default true Development false Production habilita Swagger UI endpoint /swagger documentação OpenAPI 3.0 interactive testing desabilitado produção security), DATABASE_COMMAND_TIMEOUT (int segundos timeout comandos database default 30 aumentar 120 operações batch reports generation spatial queries complexas PostGIS), KEYCLOAK_ADMIN_USERNAME (string username admin Keycloak usado bootstrap inicial realm import opcional desenvolvimento obrigatório CI/CD automatizar configuração), KEYCLOAK_ADMIN_PASSWORD (string password admin Keycloak secret nunca commitar usar Azure Key Vault AWS Secrets Manager opcional desenvolvimento obrigatório produção), SMTP_HOST (string servidor SMTP formato smtp.sendgrid.net opcional usado envio emails notificações redefinição senha boas-vindas relatórios gerados), SMTP_PORT (int porta SMTP default 587 TLS 465 SSL 25 inseguro evitar), SMTP_USERNAME (string username autenticação SMTP API key SendGrid opcional fallback console logging desenvolvimento), SMTP_PASSWORD (string password SMTP secret gerenciado externamente opcional), SMTP_FROM_EMAIL (string email remetente formato noreply@carf.example.com default noreply@localhost opcional usado campo From emails enviados), S3_BUCKET_NAME (string nome bucket AWS S3 armazenamento documentos uploads fotos units relatórios PDF gerados opcional fallback filesystem local desenvolvimento obrigatório produção escalabilidade), S3_REGION (string região AWS exemplo us-east-1 sa-east-1 default us-east-1 opcional usado construir URLs S3 endpoints), AWS_ACCESS_KEY_ID (string credencial AWS acesso S3 secret gerenciado externamente opcional desenvolvimento usar IAM roles EKS produção evitar hardcoded credentials), AWS_SECRET_ACCESS_KEY (string credencial AWS secret gerenciado externamente opcional desenvolvimento IAM roles produção), FILE_UPLOAD_MAX_SIZE_MB (int megabytes tamanho máximo upload arquivos default 10 aumentar 50 documentos escaneados PDFs plantas baixas CAD limitação Nginx client_max_body_size sincronizar), ENABLE_AUDIT_LOG (boolean habilitar audit log completo operações CRUD default true produção false desenvolvimento performance overhead async write PostgreSQL tabela audit_logs compliance LGPD rastreabilidade), FEATURE_FLAG_OFFLINE_SYNC (boolean habilitar funcionalidade sincronização offline REURBCAD default true teste A/B rollout gradual canary releases toggle runtime sem redeploy), GEOCODING_API_URL (string endpoint Nominatim OpenStreetMap formato https://nominatim.openstreetmap.org default public instance opcional self-hosted produção rate limiting SLA), GEOCODING_API_KEY (string API key Google Maps Geocoding fallback Nominatim indisponível opcional produção alta disponibilidade), SENTRY_DSN (string Data Source Name Sentry error tracking formato https://key@sentry.io/project opcional produção monitoramento erros alertas real-time integração Slack PagerDuty), HANGFIRE_DASHBOARD_ENABLED (boolean habilitar Hangfire Dashboard UI background jobs formato true false default true desenvolvimento false produção security access restrito VPN), ENABLE_RESPONSE_COMPRESSION (boolean habilitar compressão responses Gzip Brotli default true produção reduz bandwidth latência APIs retornando JSON grande listagens paginadas reports).

## GEOWEB

VITE_API_URL* (string base URL backend GEOAPI formato http://host:port/api exemplo http://localhost:5000/api desenvolvimento https://api.carf.example.com/api produção obrigatório todas chamadas Axios HTTP client configurado baseURL interceptors refresh token automatic retry 401 unauthorized), VITE_KEYCLOAK_URL* (string base URL Keycloak formato http://host:port exemplo http://localhost:8080 desenvolvimento https://keycloak.carf.example.com produção obrigatório inicialização keycloak-js biblioteca SSO login logout token refresh PKCE flow), VITE_KEYCLOAK_REALM* (string nome realm valor carf obrigatório configuração cliente Keycloak instância), VITE_KEYCLOAK_CLIENT_ID* (string identificador client público valor geoweb-spa obrigatório client type public PKCE enabled redirect URIs configurados Keycloak), VITE_ENABLE_MOCK_API (boolean habilitar mock API MSW Service Workers desenvolvimento valores true false default false útil desenvolvimento offline testes E2E Playwright sem dependência backend real fixtures JSON faker dados), VITE_MAP_TILE_URL (string URL tile server OpenStreetMap formato https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png default OSM public tiles opcional self-hosted tile server produção rate limiting cache CDN CloudFront), VITE_MAP_DEFAULT_CENTER_LAT (float latitude centro inicial mapa default -23.550520 São Paulo ajustar município predominante deployment geograficamente relevante UX), VITE_MAP_DEFAULT_CENTER_LNG (float longitude centro inicial default -46.633308 São Paulo ajustar município deployment), VITE_MAP_DEFAULT_ZOOM (int nível zoom inicial default 13 range 1-20 ajustar contexto visualização cidade 13 estado 8 país 5), VITE_SENTRY_DSN (string Sentry error tracking frontend opcional produção capturar erros JavaScript runtime unhandled promises React error boundaries source maps upload release identificar stack traces), VITE_GOOGLE_ANALYTICS_ID (string ID Google Analytics formato G-XXXXXXXXXX opcional produção métricas uso page views eventos custom user journey funnel conversão), VITE_ENABLE_DEVTOOLS (boolean habilitar Redux DevTools React Query DevTools desenvolvimento default true desenvolvimento false produção security performance), VITE_API_TIMEOUT_MS (int timeout milissegundos requests API default 30000 aumentar 60000 operações longas report generation batch operations), VITE_PAGINATION_PAGE_SIZE (int itens por página listagens default 20 ajustar 10 mobile 50 desktop UX performance trade-off).

## REURBCAD

API_URL* (string base URL backend GEOAPI formato http://host:port/api exemplo http://192.168.1.100:5000/api desenvolvimento rede local https://api.carf.example.com/api produção obrigatório sincronização dados units holders communities offline-first WatermelonDB SQLite local sync batch uploads), KEYCLOAK_URL* (string base URL Keycloak obrigatório login SSO mobile deep linking redirect carf://oauth/callback configurado identity provider), KEYCLOAK_REALM* (string realm carf obrigatório), KEYCLOAK_CLIENT_ID* (string client ID reurbcad-mobile obrigatório public client PKCE mobile OAuth2 flow), SYNC_INTERVAL_MINUTES (int intervalo minutos sincronização automática background default 30 ajustar 15 conectividade boa 60 economia bateria offline detection NetInfo listener React Native cancela sync aguarda reconexão), STORAGE_PATH (string caminho diretório armazenamento SQLite WatermelonDB default DocumentDirectory iOS Android app-specific storage scoped storage Android 10+ migration legacy paths), ENABLE_GPS_AUTO_CAPTURE (boolean habilitar captura automática GPS ao criar unit default true desabilitar false economia bateria precisão baixa usuário prefere entrada manual coordenadas), GPS_ACCURACY_THRESHOLD_METERS (int metros threshold precisão GPS mínima aceita default 10 rejeitar leituras accuracy > 10m aguardar sinal melhor timeout 30s fallback manual), PHOTO_MAX_RESOLUTION (int pixels largura máxima fotos capturadas default 1920 reduzir 1280 economia storage bandwidth upload sync comprimir JPEG quality 80 exif orientation preserve), PHOTO_COMPRESSION_QUALITY (float qualidade compressão JPEG range 0.0-1.0 default 0.8 balance qualidade tamanho arquivo legibilidade documentos fachadas), ENABLE_OFFLINE_MAPS (boolean habilitar download offline tiles mapa cache local default false opcional usuários campo sem conectividade storage intensivo 500MB cidade média tiles zoom 10-18), OFFLINE_MAPS_MAX_ZOOM (int zoom máximo tiles download offline default 18 reduzir 16 economia storage balance detalhe), ENABLE_CRASH_REPORTING (boolean habilitar crash reporting Sentry Bugsnag default true produção false desenvolvimento privacy LGPD compliance opt-in usuário), ENABLE_ANALYTICS (boolean habilitar analytics Firebase Google Analytics eventos custom default true produção opt-in LGPD termo aceite), LOG_LEVEL (enum valores debug info warn error default info desenvolvimento debug produção warn Reactotron desenvolvimento remote debugging), API_RETRY_ATTEMPTS (int tentativas retry requests falhados network timeout default 3 exponential backoff 1s 2s 4s cancel se offline persistente queue retry reconexão), API_TIMEOUT_MS (int timeout requests API default 30000 aumentar 60000 uploads fotos batch sync múltiplas units), ENABLE_BIOMETRIC_AUTH (boolean habilitar autenticação biométrica FaceID TouchID fingerprint Android default true opcional após primeiro login SSO cache credentials encrypted Keychain KeyStore), SESSION_TIMEOUT_MINUTES (int minutos inatividade logout automático default 30 security compliance ajustar 60 campo técnicos trocas contexto frequentes evitar re-login constante UX friction).

## GEOGIS

API_URL* (string base URL backend GEOAPI obrigatório comunicação HTTP requests Python plugin QGIS desktop application formato http://localhost:5000/api desenvolvimento https://api.carf.example.com/api produção network access firewall rules permitir QGIS PyQt5 QNetworkAccessManager SSL verification), KEYCLOAK_URL* (string Keycloak obrigatório login SSO desktop OAuth2 desktop flow redirect http://localhost:8090/callback local HTTP server temporário capturar authorization code), KEYCLOAK_REALM* (string realm carf obrigatório), KEYCLOAK_CLIENT_ID* (string client ID geogis-desktop obrigatório confidential client desktop application client secret embedded ofuscado não seguro 100% warning usuários), QGIS_PLUGIN_DIR (string caminho instalação plugin QGIS default ~/.local/share/QGIS/QGIS3/profiles/default/python/plugins/carf-geogis Linux %APPDATA%\QGIS\QGIS3\profiles\default\python\plugins\carf-geogis Windows override instalações custom profiles múltiplos), ENABLE_DEBUG_LOGGING (boolean habilitar logging debug verbose QGIS message log default false desenvolvimento true debug investigação erros PyQGIS API QgsMessageLog), LAYER_REFRESH_INTERVAL_SECONDS (int segundos intervalo refresh automático layers PostgreSQL connection units holders communities real-time updates default 60 ajustar 30 ambiente colaborativo múltiplos usuários editando simultaneamente 300 economia recursos database load), POSTGRES_CONNECTION_TIMEOUT (int segundos timeout connection PostgreSQL direct connection alternativa REST API queries espaciais complexas ST_Intersects ST_Buffer analysis tools QGIS Processing default 10 aumentar 30 network latency VPN), ENABLE_SPATIAL_INDEX_CACHE (boolean habilitar cache local spatial indexes GeoPackage otimização queries repeated ST_Contains checks rendering performance default true desenvolvimento produção), TEMP_LAYER_STORAGE_PATH (string caminho diretório storage layers temporários GeoPackage scratch workspace análises intermediárias default sistema temp dir override SSD performance disk I/O intensivo).

## WEBDOCS

VITE_BASE_URL (string caminho base deploy GitHub Pages S3 CloudFront formato /carf-docs/ subpath https://docs.carf.example.com/ custom domain default / root deployment obrigatório VitePress config base option assets links relativos absolutos corretos routing SPA), VITE_ALGOLIA_APP_ID (string ID aplicação Algolia DocSearch indexação busca full-text documentação opcional produção melhor UX search nativo VitePress limitado Algolia crawler automático scraping site indexing real-time), VITE_ALGOLIA_API_KEY (string API key search-only Algolia público safe embed frontend), VITE_ALGOLIA_INDEX_NAME (string nome index Algolia default carf-docs separar ambientes staging produção), VITE_GOOGLE_ANALYTICS_ID (string GA4 tracking opcional métricas acesso páginas mais visitadas search queries usuários públicos internos segmentação), VITE_ENABLE_EDIT_LINK (boolean habilitar links Edit this page rodapé páginas redirecionando GitHub source markdown permitindo contribuições pull requests default true interno false público read-only), GITHUB_REPO_URL (string URL repositório GitHub formato https://github.com/org/carf-docs usado construir edit links issue reporting feedback), SYNC_CRON_SCHEDULE (string cron expression agendamento sincronização automática docs CENTRAL repositório carf-docs formato 0 2 * * * diariamente 2am UTC CI/CD GitHub Actions workflow trigger fetch latest markdown rebuild deploy), FILTER_PRIVATE_CONTENT (boolean habilitar filtro remoção conteúdo privado script filter-private.js build time parsing frontmatter YAML private: true flag seções sensíveis SECURITY/INCIDENTS credenciais IPs internos default true público false build interno completo), ENABLE_MERMAID_DIAGRAMS (boolean habilitar plugin Mermaid rendering diagramas markdown default true diagramas ER workflows state machines architecture essential visual documentation), ENABLE_DARK_MODE (boolean habilitar tema escuro toggle default true acessibilidade preferência usuário persistência localStorage), CONTENT_SOURCE_PATH (string caminho source documentação markdown default ../../CENTRAL relativo WEBDOCS/SRC-CODE apontando CENTRAL symlink alternativa copy build time sync script automation).

## Secrets Management

Variáveis marcadas asterisco * são obrigatórias todas ambientes sem valores default aplicação falha startup validação Program.cs throw exception missing required configuration. Secrets sensíveis passwords API keys connection strings database JWT secrets nunca commitados repositório Git .gitignore incluindo .env .env.local .env.*.local arquivos desenvolvimento local usar .env.example template placeholders <REPLACE_WITH_ACTUAL_VALUE> documentação. Staging produção usar gerenciadores secrets cloud Azure Key Vault armazenamento centralizado secrets acesso controlado RBAC Azure AD service principals managed identities injeção runtime variáveis ambiente Kubernetes pods annotations secrets-store-csi-driver sincronização automática rotação trimestral audit logs compliance ou AWS Secrets Manager similar funcionalidade Lambda rotation policies KMS encryption IAM roles EKS pods service accounts IRSA injection containers environment variables volumes mounted /mnt/secrets read-only. CI/CD pipelines GitHub Actions secrets repository settings encrypted variables workflows acesso jobs steps never echo print logs masked automatically exposing secrets build logs artifacts. Local desenvolvimento desenvolvedores criar .env.local próprio gitignored copiar .env.example preencher valores desenvolvimento inseguros exemplo passwords simples dev_password localhost URLs mock APIs nunca usar produção credentials desenvolvimento contaminação ambientes separação estrita networks databases tenants. Rotation secrets produção política trimestral JWT_SECRET database passwords API keys externos coordenação equipe DevOps SRE comunicação antecipada 2 semanas janela manutenção downtime zero rolling restart pods Kubernetes secrets updated ConfigMap reload graceful shutdown SIGTERM handling. Validação formato variáveis startup aplicação regex parsing URLs verificação conectividade dependencies health checks PostgreSQL Redis Keycloak retry exponential backoff timeout 30s fail fast exception clara logs indicando variável inválida missing facilitando troubleshooting deployment failures pods CrashLoopBackOff investigate logs kubectl logs pod-name container-name.

---

**Última atualização:** 2025-01-07
