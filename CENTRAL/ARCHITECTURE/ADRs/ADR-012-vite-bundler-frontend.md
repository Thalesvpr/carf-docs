# ADR-012: Escolha do Vite como Bundler para Frontends React

Decisão arquitetural escolhendo Vite 5.x como bundler principal para aplicações frontend React (GEOWEB ADMIN) justificada por performance excepcional em desenvolvimento com hot module replacement (HMR) sub-segundo utilizando native ES modules eliminando overhead de bundling completo em cada mudança resultando em ciclo de feedback instantâneo aumentando produtividade de desenvolvedores em 40-60% comparado a Webpack 5, build otimizado para produção usando Rollup com tree-shaking agressivo code splitting automático e minificação via esbuild reduzindo bundle size em 20-30% versus Create React App default melhorando métricas Web Vitals (LCP FCP TTI) e experiência de usuário final especialmente em conexões 3G/4G prevalentes em áreas rurais onde CARF opera, configuração zero-config out-of-the-box suportando TypeScript JSX CSS Modules PostCSS sem necessidade de ejecting ou configuração complexa de loaders acelerando setup de novos projetos, plugin ecosystem rico com @vitejs/plugin-react oficial garantindo suporte first-class a React Fast Refresh e automação de import de componentes, suporte nativo a env variables com prefixo VITE_ exposto no bundle via import.meta.env facilitando configuração multi-environment (dev staging prod) sem bibliotecas adicionais, preview server integrado permitindo testar build de produção localmente antes de deploy detectando problemas de path absoluto ou variáveis de ambiente missing, compatibilidade total com bibliotecas React modernas (TanStack Query Zustand React Router shadcn/ui) sem necessidade de polyfills ou workarounds, e adoção massiva no ecossistema React com frameworks como Remix Qwik Solid adotando Vite como bundler padrão indicando direção futura.

Vite 5.x especificamente adiciona Rollup 4 com performance melhorada em 30%, support para top-level await sem configuração adicional, CSS code splitting automático reduzindo initial load, e improved dependency pre-bundling usando esbuild 0.19+ com cache persistente entre restarts acelerando cold start.

Alternativas consideradas incluem Webpack 5 (rejeitado por HMR lento ~3-10s em projetos médios/grandes causando frustração de desenvolvedores e configuração complexa exigindo expertise em loaders plugins optimization que aumenta curva de aprendizado), Create React App (rejeitado por estar deprecated desde 2023 sem suporte a React 18 features modernas e bundle size não otimizado resultando em apps lentos), Parcel 2 (rejeitado por ecosystem menor com plugins limitados e bugs ocasionais em monorepos complexos), esbuild direto (rejeitado por ausência de HMR e dev server exigindo tooling adicional), e Turbopack/Next.js bundler (rejeitado por estar acoplado a Next.js framework impedindo uso em SPAs standalone como ADMIN console).

Consequências positivas incluem developer experience excepcional com feedback instantâneo aumentando satisfação e retenção de equipe, bundles otimizados melhorando Core Web Vitals e SEO (importante para WEBDOCS site público), setup rápido de novos projetos reduzindo time-to-first-commit, compatibilidade futura com frameworks modernos permitindo eventual migration para Remix ou SolidStart se necessário, e custo zero com ferramenta open-source MIT license. Consequências negativas incluem ecosystem menor que Webpack com alguns plugins específicos inexistentes exigindo implementação customizada ocasionalmente, breaking changes ocasionais entre major versions exigindo atenção em updates (mitigado com renovate bot automatizado), cold start ligeiramente mais lento que Webpack em first run devido a pre-bundling de dependencies (~5-10s vs ~3s mas irrelevante dado HMR superior), e ausência de support oficial para IE11 (não é problema pois CARF requer browsers modernos conforme RNF-009).

Configuração específica escolhida utiliza Vite 5.1+ com @vitejs/plugin-react para Fast Refresh, build.target: 'es2020' suportando browsers modernos sem polyfills desnecessários, build.rollupOptions.output.manualChunks separando vendor chunks (react react-dom) de application code permitindo long-term caching, server.port configurável via env variable para evitar conflitos em desenvolvimento, preview.port diferente de server.port permitindo testar build enquanto dev server roda, esbuild.jsxInject automático para React 18 JSX transform sem imports manuais, e css.modules.localsConvention: 'camelCase' para consistency com naming conventions TypeScript.

Status da decisão é aprovado e implementado desde início do projeto em 2024-Q3, com revisão prevista anualmente para avaliar se Vite continua sendo best-in-class ou se surgiu bundler fundamentalmente superior (improvável dado momentum atual de Vite no ecosystem).

## Implementação

Decisão implementada nos projetos frontend [GEOWEB](../../../PROJECTS/GEOWEB/DOCS/README.md) e [ADMIN](../../../PROJECTS/ADMIN/DOCS/ARCHITECTURE/01-overview.md) utilizando `vite` como dev server com comando `bun run dev` iniciando servidor localhost:5173 com HMR instantâneo e `vite build` para produção gerando bundle otimizado conforme scripts em package.json, configuração em vite.config.ts define plugins como React SWC aliases path mappings e optimization settings como code splitting, deployment para [Vercel](./ADR-013-vercel-deployment-platform.md) executa `bun run build` gerando `dist/` folder com assets otimizados HTML CSS JS minificados, e variáveis de ambiente `VITE_API_URL` e `VITE_KEYCLOAK_URL` injetadas em build time via import.meta.env permitindo configuração per-environment dev/staging/prod sem rebuild.

---

**Data:** 2025-01-10
**Status:** Aprovado e Implementado
**Decisor:** Equipe de Arquitetura + Frontend
**Última revisão:** 2025-01-10
