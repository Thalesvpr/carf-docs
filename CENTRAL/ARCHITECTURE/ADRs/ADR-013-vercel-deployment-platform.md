# ADR-013: Escolha do Vercel como Plataforma de Deploy para Frontends

Decisão arquitetural escolhendo Vercel como plataforma de hosting e deployment para aplicações frontend estáticas (GEOWEB ADMIN WEBDOCS) justificada por integração nativa com GitHub permitindo preview deployments automáticos em cada Pull Request habilitando revisão visual de mudanças antes de merge para main aumentando qualidade e reduzindo bugs em produção, CDN global Edge Network com 100+ POPs (Points of Presence) distribuídos mundialmente garantindo latência < 50ms para 95% dos usuários brasileiros através de edge caching agressivo de assets estáticos melhorando significativamente métricas Web Vitals (LCP TTI) especialmente crítico para usuários em regiões remotas com conectividade limitada, SSL/TLS automático com certificados Let's Encrypt renovados automaticamente eliminando overhead operacional de gestão manual de certificados e garantindo HTTPS obrigatório conforme políticas de segurança SECURITY/POLICIES/ e compliance LGPD exigindo dados em trânsito criptografados, zero-downtime deployments com rollback instantâneo através de immutable deployments onde cada build recebe URL único permitindo reverter para versão anterior em segundos sem rebuild em caso de incident crítico, analytics integrado fornecendo métricas de Core Web Vitals Real User Monitoring page views unique visitors sem necessidade de Google Analytics ou ferramentas third-party reduzindo surface de tracking e melhorando privacidade, custom domains com DNS management simplificado suportando apex domains e wildcard subdomains permitindo estrutura multi-tenant como `município.carf.gov.br` para white-labeling futuro, environment variables secretas criptografadas em rest e transit permitindo armazenar API keys e tokens com segurança auditável, build cache inteligente detectando mudanças em dependencies apenas reinstalando packages modificados acelerando builds em 50-70%, e custo zero para projetos open-source ou não-comerciais através de Hobby tier com limites generosos (100GB bandwidth, unlimited deployments) suficiente para escala inicial com upgrade path suave para Pro tier quando necessário.

Vercel especificamente otimiza frameworks baseados em Vite/React com detecção automática de framework zerando configuração manual, Image Optimization service automático convertendo imagens para WebP/AVIF com responsive sizes reduzindo payload em 60-80%, serverless functions para APIs simples se necessário permitindo BFF (Backend for Frontend) leve sem infraestrutura adicional, e Web Analytics privacy-focused compliant com GDPR/LGPD sem cookies ou tracking invasivo.

Alternativas consideradas incluem Netlify (rejeitado por performance ligeiramente inferior de Edge Network em América Latina com latências ~10-20% maiores conforme benchmarks independentes e pricing menos competitivo em tier Pro), AWS Amplify (rejeitado por vendor lock-in AWS complexidade de configuração comparado a simplicidade Vercel e cold start ocasional de deployments), GitHub Pages (rejeitado por limitações de custom domains ausência de preview deployments automáticos e impossibilidade de environment variables dinâmicas), Cloudflare Pages (rejeitado por ecosystem menor com integrações limitadas e ausência de analytics integrado exigindo setup manual de Cloudflare Analytics), self-hosted Nginx (rejeitado por overhead operacional enorme exigindo gerenciamento manual de SSL CDN monitoring backups security patches consumindo tempo de equipe pequena que poderia focar em features), e Render (rejeitado por pricing superior a Vercel sem benefícios claros adicionais).

Consequências positivas incluem developer experience excepcional com deployments automáticos em git push eliminando steps manuais de build/upload, preview URLs facilitando code review visual e stakeholder feedback antes de produção, performance excelente melhorando retention e satisfaction de usuários finais, custo inicial zero permitindo validação de produto antes de investimento em infraestrutura cara, observabilidade integrada reduzindo necessidade de ferramentas externas, e escalabilidade automática handling spikes de tráfego sem configuração manual ou downtime. Consequências negativas incluem vendor lock-in parcial com APIs proprietárias de Vercel dificultando eventual migration (mitigado usando apenas features standard de static hosting sem serverless functions complexas), custos potencialmente altos em escala enterprise com milhões de requests mensais podendo justificar self-hosted alternativo (monitorado com alertas de billing), impossibilidade de rodar workloads backend complexos exigindo arquitetura separada com GEOAPI em Kubernetes (já planejado), e dependência de disponibilidade da plataforma Vercel onde outage afeta todos projetos simultaneamente (mitigado com fallback DNS para versão cached ou maintenance page).

Configuração específica escolhida utiliza Vercel CLI 33.x para deploys locais e debugging, vercel.json configurando rewrites para SPA routing (/* → /index.html), headers customizados para security (X-Frame-Options CSP HSTS), redirects para URLs legados preservando SEO, environment variables separadas por ambiente (Production Preview Development) com secrets para API keys sensíveis, build command `bun run build` gerando output em `dist/` ou `.next/` dependendo de framework, deploy hooks para invalidar caches externos ou notificar Slack em deploy bem-sucedido, e integration com GitHub branch protections exigindo preview deployment successo antes de merge.

Status da decisão é aprovado e implementado desde início do projeto em 2024-Q3, com revisão prevista semestralmente para avaliar custos versus benefícios e considerar alternatives se pricing se tornar proibitivo em escala (monitorado com budget alerts em $100/mês threshold).

## Implementação

Decisão implementada nos projetos frontend [GEOWEB](../../../PROJECTS/GEOWEB/DOCS/ARCHITECTURE/05-deployment.md), [ADMIN](../../../PROJECTS/ADMIN/DOCS/ARCHITECTURE/05-deployment.md) e [WEBDOCS](../../../PROJECTS/WEBDOCS/DOCS/ARCHITECTURE/05-deployment.md) com deployment automático via GitHub integration executando `bun run build` em cada push para main gerando production deploy e preview deploys em PRs, configuração em vercel.json define rewrites headers redirects, environment variables `VITE_API_URL` e `VITE_KEYCLOAK_URL` configuradas em Vercel dashboard por ambiente, custom domains configurados via DNS CNAME apontando para cname.vercel-dns.com, e analytics Vercel habilitado fornecendo Core Web Vitals metrics acessíveis em dashboard.

---

**Data:** 2025-01-10
**Status:** Aprovado e Implementado
**Decisor:** Equipe de Arquitetura + DevOps
**Última revisão:** 2025-01-10
