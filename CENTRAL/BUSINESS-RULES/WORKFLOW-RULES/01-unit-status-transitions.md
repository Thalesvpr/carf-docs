# Unit Status Transitions

Regras governando transições status Unit unidade habitacional longo ciclo vida desde criação inicial rascunho até aprovação final rejeição estabelecendo máquina estados define quais mudanças status permitidas partir cada estado atual quais validações devem satisfeitas antes cada transição quais roles papéis têm permissão executar cada mudança garantindo integridade processo cadastramento validação legitimação propriedades status inicial Unit recém-criada sempre DRAFT rascunho permitindo field agent cadastre informações básicas forma incremental sem obrigatoriedade completude imediata possibilitando trabalho offline salvamento frequente progresso parcial sincronização posterior conexão restabelecida Unit DRAFT pode editada livremente criador membros mesma equipe Team sem restrições não visível analistas gestores trabalham apenas unidades submetidas validação transição DRAFT para PENDING_ANALYSIS ocorre field agent considera cadastro completo submete Unit validação clicando botão Enviar para Análise sendo validado automaticamente unidade possui menos um Holder vinculado titular primário CPF validado endereço preenchido geometria espacial definida polígono ponto GPS área calculada status ocupação declarado menos uma fotografia anexada Document comprovando existência física edificação transição permitida qualquer usuário permissão units.submit roles FIELD_AGENT ANALYST MANAGER ADMIN SUPER_ADMIN tipicamente executada field agent coletou dados campo podendo revertida DRAFT próprio usuário identifique erro antes analista inicie revisão transição PENDING_ANALYSIS para IN_REVIEW ocorre analyst assume responsabilidade validar Unit clicando botão Iniciar Análise estabelecendo lock otimista impede outros analistas editarem mesma unidade simultaneamente evitando conflitos edição concorrente garantindo cada Unit revisada exatamente um analista vez transição permitida apenas usuários permissão units.review roles ANALYST MANAGER ADMIN SUPER_ADMIN sistema automaticamente registra quem iniciou análise campo reviewed_by_account_id timestamp início reviewed_at permitindo rastreabilidade métricas produtividade individual analistas.

Transição IN_REVIEW para APPROVED ocorre analyst valida todas informações cadastradas corretas completas consistentes clicando botão Aprovar Unidade após verificar visualmente geometria espacial corresponde footprint edificação visível ortofoto referência WMS dados titular coerentes documentos anexados área calculada dentro limites legais REURB não há sobreposição significativa unidades vizinhas já aprovadas transição permitida apenas usuários permissão units.approve roles MANAGER ADMIN SUPER_ADMIN sendo vedada analistas comuns podem apenas recomendar aprovação não efetivá-la estabelecendo segregação responsabilidades exige dupla verificação analyst revisa manager aprova decisões críticas habilitam Unit participar processo legitimação fundiária transição IN_REVIEW para REJECTED ocorre analyst manager identifica problemas graves impedem aprovação Unit cadastro titular CPF inválido duplicado geometria espacial auto-interseção área muito discrepante realidade visível ortofoto evidências ocupação não residencial comercial industrial documentos anexados ilegíveis adulterados qualquer outra irregularidade comprometa validade cadastro fins regularização fundiária transição exige preenchimento obrigatório campo rejection_reason explicando motivo rejeição linguagem clara acessível field agent possa corrigir problemas identificados resubmeter unidade posteriormente sendo vedado rejeitar sem justificativa detalhada oriente correções necessárias após rejeição Unit retorna automaticamente status DRAFT permitindo edições criador original outros membros equipe correção problemas antes nova submissão transição IN_REVIEW para REQUIRES_CHANGES ocorre analyst identifica problemas menores podem corrigidos rapidamente sem exigir nova coleta campo pequenas inconsistências dados endereço fotografias adicionais necessárias melhor documentar propriedade esclarecimentos situação fundiária declarada transição registra lista correções solicitadas campo required_changes_notes Unit retornada status DRAFT mantendo histórico tentativa aprovação anterior motivos devolução permitindo field agent corrigir apenas itens apontados sem refazer cadastro completo economizando tempo evitando retrabalho desnecessário transições reversas APPROVED REJECTED volta estados anteriores geralmente vedadas preservar integridade decisões já tomadas evitar manipulação retroativa dados após aprovação formal podem excepcionalmente autorizadas usuários role ADMIN SUPER_ADMIN mediante justificativa documentada campo override_reason registrada AuditLog fins compliance auditoria posterior identificado erro grave justifique revisão decisão já efetivada descoberta posterior fraude duplicação não detectada inicialmente mudança interpretação legal invalida aprovação anterior.

Validações automáticas executadas antes cada transição incluem verificação completude campos obrigatórios conforme status destino conferência integridade referencial garantindo entidades relacionadas Holder Community Block Documents existem estão estados válidos cálculo regras negócio área dentro limites REURB ausência overlaps críticos unidades vizinhas confirmação permissões usuário executante verificando possui role adequado Unit pertence Community qual tem CommunityAuthorization ativa permissão edição garantindo isolamento multi-tenant controle acesso granular comunidade estados Unit UnitStatus enum incluem DRAFT rascunho edição não validado PENDING_ANALYSIS aguardando análise analista IN_REVIEW em revisão analista específico APPROVED aprovado pronto legitimação REJECTED rejeitado requer correções REQUIRES_CHANGES requer alterações menores transições permitidas DRAFT para PENDING_ANALYSIS cadastro completo permissão units.submit validações Holder vinculado geometria fotos PENDING_ANALYSIS para IN_REVIEW analyst assume permissão units.review validações analyst disponível sem lock IN_REVIEW para APPROVED validação OK permissão units.approve validações área válida sem overlaps documentos OK IN_REVIEW para REJECTED problemas graves permissão units.approve rejection_reason obrigatório IN_REVIEW para REQUIRES_CHANGES correções menores permissão units.review required_changes_notes obrigatório REQUIRES_CHANGES para DRAFT auto após registro retorna edição REJECTED para DRAFT auto após registro permite correções APPROVED para DRAFT excepcional permissão units.override override_reason mais AuditLog permissões role FIELD_AGENT DRAFT para PENDING_ANALYSIS submit ANALYST PENDING_ANALYSIS para IN_REVIEW review IN_REVIEW para REQUIRES_CHANGES MANAGER IN_REVIEW para APPROVED REJECTED approve ADMIN SUPER_ADMIN todas transições mais overrides validações automáticas transição DRAFT para PENDING_ANALYSIS Holder primário geometria válida área maior zero uma mais foto endereço completo IN_REVIEW para APPROVED área vinte a quinhentos metros quadrados sem overlaps maior um por cento documentos obrigatórios geometria topológica válida IN_REVIEW para REJECTED rejection_reason preenchido analyst_id registrado overrides override_reason mais aprovação ADMIN mais AuditLog entry lock otimista IN_REVIEW campo reviewed_by_account_id registra analyst campo reviewed_at registra timestamp início timeout duas horas libera lock automaticamente outro analyst não pode assumir enquanto locked.

Relacionado domain model UnitStatus value object enum Unit aggregate state machine eventos UnitStatusChangedEvent implementações backend .NET frontend React mobile React Native submit button enabled disabled.

---

**Última atualização:** 2026-01-11
**Status do arquivo**: Review
