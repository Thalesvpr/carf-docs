# Geometry Validation

Regra validação geometrias espaciais garantindo polígonos representando unidades habitacionais comunidades blocos são válidos topologicamente compatíveis requisitos regularização fundiária onde validação inclui verificação polígono fechado primeiro ponto igual último ausência auto-interseção arestas não cruzam sentido rotação correto anti-horário exterior horário buracos área calculada dentro limites legais REURB-S até duzentos cinquenta metros quadrados REURB-E até quinhentos metros quadrados perímetro coerente área detecção sobreposição geometrias adjacentes geometrias fornecidas formatos padrão WKT Well-Known Text ou GeoJSON convertidas internamente representação canônica antes validação armazenamento cálculo área utiliza fórmula Shoelace método determinante polígonos simples coordenadas planas projetadas considerando áreas pequenas menor um quilômetro quadrado distorção projeção desprezível caso contrário transformar projeção equivalente usar cálculo esférico validação overlap unidades detecta sobreposição polígonos indicando conflito fundiário erro cadastro onde overlap maior threshold tolerância tipicamente um metro quadrado ou um por cento menor área dispara alerta revisão manual.

Tipos geometria suportados incluem Polygon polígono simples sem buracos caso mais comum unidades MultiPolygon múltiplos polígonos propriedades não contíguas Polygon with holes polígono buracos internos edificações pátios validações topológicas obrigatórias garantem polígono fechado primeiro ponto igual último ponto mesmas coordenadas mínimo quatro pontos três vértices mais fechamento sem auto-interseção nenhuma aresta cruza outra aresta mesmo polígono algoritmo verificar interseção cada par arestas não adjacentes sentido rotação anel exterior anti-horário CCW counter-clockwise anéis interiores buracos horário CW clockwise determinar sentido somar x dois menos x um vezes y dois mais y um cada aresta se negativo igual CCW área válida área maior zero não degenerado área maior igual área mínima exemplo vinte metros quadrados construção habitável área menor igual área máxima duzentos cinquenta metros quadrados REURB-S quinhentos metros quadrados REURB-E vértices distintos nenhum vértice duplicado exceto primeiro último distância vértices consecutivos maior threshold exemplo zero ponto um metro.

Cálculo área fórmula Shoelace para polígono com n vértices x um y um x dois y dois até x n y n calcula Área igual valor absoluto meio vezes somatório xi vezes y índice i mais um menos x índice i mais um vezes yi para i igual um até n menos um onde coordenadas estão metros projetadas resultado metros quadrados aplicando método determinante polígonos simples transformação cálculo Latitude Longitude EPSG quatro três dois seis para UTM zona apropriada metros Brasil fusos UTM dezoito a vinte e cinco escolher fuso centroide exemplo São Paulo igual UTM zona vinte e três S EPSG trinta e um nove oito três cálculo perímetro fórmula calcula Perímetro igual somatório distância vértice i e vértice i mais um para i igual um até n menos um somando comprimento todas arestas polígono validando razão área dividido perímetro ao quadrado índice circularidade detectar polígonos muito irregulares alongados índice circularidade igual quatro pi vezes área dividido perímetro ao quadrado valores próximos um circular menor zero ponto um muito irregular.

Detecção overlap entre Units calcula interseção geometrias área overlap maior threshold um metro quadrado ou um por cento menor área alertar analista revisão Unit fora Community boundary validar Unit geometry está contido Community boundary tolerância aceitar menor um por cento área fora erro GPS Unit fora Block aplicável validar Unit geometry está contido Block geometry mesmo critério tolerância validações qualidade relação área perímetro detectar polígonos muito alongados irregulares valores próximos um circular menor zero ponto um muito irregular número vértices mínimo quatro triângulo mais fechamento máximo razoável cem simplificar se muito complexo alerta maior cinquenta vértices provável digitalização detalhada desnecessária ângulos internos evitar ângulos muito agudos menor quinze graus indicam erro digitalização vértices redundantes.

Formatos entrada WKT Well-Known Text formato textual inicia palavra-chave POLYGON seguida parênteses duplos contendo lista coordenadas longitude latitude separadas vírgula primeiro ponto repetido final fechando polígono exemplo POLYGON parênteses parênteses menos quarenta e seis ponto seis três três menos vinte e três ponto cinco cinco zero vírgula vértices intermediários vírgula primeiro ponto repetido parênteses parênteses GeoJSON formato JSON estruturado objeto raiz contendo propriedade type igual string Polygon propriedade coordinates igual array arrays array externo representa anel exterior array interno contém coordenadas cada coordenada array dois números longitude latitude exemplo menos quarenta e seis ponto seis três três vírgula menos vinte e três ponto cinco cinco zero ordenados anti-horário primeiro ponto repetido final fechando polígono conforme especificação GeoJSON RFC 7946 mensagens erro geometria inválida polígono não está fechado geometria inválida auto-interseção detectada geometria inválida sentido rotação incorreto área inválida excede limite duzentos cinquenta metros quadrados REURB-S área inválida menor vinte metros quadrados área mínima habitável sobreposição detectada unidade adjacente cinco ponto dois metros quadrados revisar unidade fora perímetro comunidade doze por cento área externa.

Exceções casos especiais propriedades não contíguas usar MultiPolygon ao invés Polygon cada parte validada individualmente somar áreas todas partes edificações pátio interno Polygon with holes anel exterior mais anéis interiores validar sentido cada anel área igual área externa menos área buracos correção automática inverter sentido rotação se incorreto remover vértices duplicados simplificar geometria reduzir vértices mantendo forma.

Relacionado domain model GeoPolygon value object implementando validação Unit entity usando geometria validada legitimation-rules reurb-s-requirements limite duzentos cinquenta metros quadrados área reurb-e-requirements limite quinhentos metros quadrados área implementações backend .NET NetTopologySuite frontend React Turf.js Plugin QGIS Shapely PostGIS spatial validation ST_IsValid.

---

**Última atualização:** 2026-01-11
