# CommunityBoundaryChangedEvent

Domain event emitido por Community aggregate root quando geometria boundary delimitando perímetro espacial da comunidade é modificada representando fato que área geográfica de regularização foi expandida reduzida ou ajustada exigindo recalcular estatísticas espaciais e validar unidades habitacionais ainda estão dentro do perímetro. Payload do evento contém identificador da comunidade cujo boundary foi alterado, geometria boundary anterior preservando estado pré-mudança para auditoria e possível rollback, geometria boundary nova após modificação, área calculada em metros quadrados antes da mudança, área calculada após mudança útil para métricas de impacto, identificador do Account que executou alteração rastreando responsabilidade administrativa especialmente importante para mudanças significativas de perímetro, motivo ou justificativa da alteração documentando razão técnica ou legal para ajuste de boundary, identificador do tenant para isolamento multi-tenant, e timestamp UTC quando alteração ocorreu permitindo rastreamento temporal de evolução da comunidade. Event handlers subscribers processam evento executando side effects críticos como validar assincronamente que todas Units existentes ainda estão dentro do novo boundary detectando unidades que ficaram fora após redução de perímetro e disparando alerta para revisão manual, recalcular estatísticas espaciais da comunidade atualizando área total perímetro e centroide geométrico, invalidar cache de visualização de mapa forçando refresh de camadas vetoriais que exibem boundary, atualizar índice espacial de busca reindexando geometria para queries de intersecção e proximidade manterem performance, gerar relatório de impacto listando quantas unidades foram afetadas quantas ficaram fora do boundary e quais precisam relocação ou reclassificação, registrar em audit trail mudança de boundary para compliance legal especialmente importante em processos de legitimação onde perímetro é definido por decreto ou portaria, notificar gestores de regularização fundiária sobre mudança significativa de área permitindo revisão de planejamento de campo e cronograma de levantamento, disparar recalculo de blocos urbanos Blocks validando que geometrias de blocos ainda estão dentro de community boundary e sinalizando inconsistências, e atualizar sistemas integrados externos como cartório ou órgão regulador notificando sobre alteração de perímetro de área de regularização. Motivação do evento permite manter consistência espacial onde mudança de boundary pode invalidar dados dependentes como unidades blocos ou pontos de coleta, facilita auditoria de mudanças geográficas preservando histórico completo de evolução de perímetro da comunidade essencial para rastreabilidade legal, habilita validações complexas detectando unidades órfãs que ficaram fora do boundary após redução permitindo correção antes de aprovação de processos, e suporta workflows de aprovação onde mudança de boundary pode requerer validação de múltiplos stakeholders disparando notificações para cadeia de aprovação. Regras de processamento estabelecem que evento é despachado apenas após SaveChanges garantindo que nova geometria foi persistida com sucesso e validada como polígono fechado sem auto-interseções, handlers de validação espacial executam em background job separado prevenindo bloqueio de operação principal, detecção de unidades fora do boundary dispara workflow de correção mas não reverte mudança de boundary permitindo ajuste manual caso necessário, e idempotência é crítica especialmente para recalculo de índices espaciais evitando processamento duplicado de mesma geometria em caso de retry de evento.

**Implementações por projeto:**
- Backend .NET: `PROJECTS/GEOAPI/LAYERS/DOMAIN/EVENTS/community-boundary-changed-event.cs`
- Frontend React: Não se aplica (eventos backend)
- Mobile React Native: Sync queue conceito similar
- Plugin GIS: Não se aplica

---

**Última atualização:** 2025-01-06
