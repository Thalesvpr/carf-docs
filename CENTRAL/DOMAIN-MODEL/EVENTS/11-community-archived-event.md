# CommunityArchivedEvent

Domain event emitido por Community aggregate root quando comunidade é arquivada após conclusão de processo de regularização fundiária ou cancelamento definitivo representando fato que área de trabalho foi encerrada exigindo limpeza de recursos ativos e preservação de histórico para auditoria sem permitir novas modificações. Payload do evento contém identificador da comunidade arquivada, motivo de arquivamento enumerado (REGULARIZACAO_CONCLUIDA CANCELADO_SEM_VIABILIDADE DUPLICATA ERRO_CADASTRAL) categorizando razão para encerramento, justificativa textual detalhada opcional documentando contexto administrativo ou legal, identificador de processo de legitimação concluído se arquivamento ocorreu após aprovação final vinculando comunidade a certidão emitida, identificador do Account que executou arquivamento rastreando responsabilidade administrativa, data de conclusão ou cancelamento marcando fim oficial de trabalho na área, identificador do tenant para isolamento multi-tenant, e timestamp UTC quando arquivamento ocorreu para rastreamento temporal. Event handlers subscribers processam evento executando side effects como marcar todas Units da comunidade como arquivadas propagando estado de encerramento em cascata para entidades dependentes, revogar todas CommunityAuthorizations ativas removendo acesso de teams e accounts prevenindo edições acidentais em comunidade encerrada, invalidar cache de listagens de comunidades ativas forçando refresh de queries que excluem arquivadas por padrão, mover documentos anexos e fotos para storage de arquivo frio otimizando custos mantendo disponibilidade para auditoria, gerar relatório final consolidado de comunidade incluindo estatísticas de unidades titulares processos aprovados e documentação completa, registrar em audit trail arquivamento com motivo e justificativa para compliance legal especialmente importante para processos de legitimação onde histórico é requerido por legislação, enviar notificação para gestores de regularização fundiária informando conclusão de trabalho na área com métricas de resultado, decrementar contador de comunidades ativas em dashboard de métricas atualizando visão de trabalho em andamento, remover comunidade de configuração de sincronização offline em todos devices prevenindo download desnecessário de dados arquivados, e disparar webhook para sistemas externos integrados notificando conclusão ou cancelamento de área de regularização. Motivação do evento permite lifecycle management de comunidades onde áreas concluídas não poluem listagens ativas mas histórico é preservado para auditoria e consulta, facilita compliance com legislação de regularização fundiária onde processos finalizados devem ser preservados por período mínimo legal (5+ anos) mas não permitem modificação, habilita otimização de recursos movendo dados inativos para storage mais barato e removendo de índices de busca frequente melhorando performance de queries ativas, e suporta workflows de revisão onde arquivamento pode ser revertido por gestor em caso de erro ou necessidade de reprocessamento. Regras de processamento estabelecem que evento é despachado após SaveChanges garantindo que flag Archived foi persistida e DeletedAt populado para soft delete, handlers de propagação em cascata executam em background job separado processando potencialmente milhares de unidades sem bloquear operação principal, revogação de acessos dispara AccessRevokedEvent para cada authorization permitindo limpeza de dados locais em mobile, e idempotência é crítica especialmente para movimentação de storage prevenindo duplicação de arquivos em caso de retry de evento.

**Módulos:** GEOAPI, GEOWEB, REURBCAD, GEOGIS

---

**Última atualização:** 2026-01-10
**Status do arquivo**: Review
