# BlockAddedEvent

Domain event emitido por Community aggregate root quando novo Block quadra urbana é adicionado à estrutura espacial da comunidade representando fato que subdivisão territorial foi estabelecida permitindo organização hierárquica de unidades habitacionais e facilitando gestão de áreas de regularização em zonas urbanas formais. Payload do evento contém identificador da comunidade à qual block foi adicionado, identificador único do block criado permitindo subscribers localizarem entity completa, código identificador legível do block único dentro da comunidade facilitando referência humana, nome descritivo opcional do block útil para identificação por residentes, geometria poligonal do block delimitando perímetro espacial, área calculada em metros quadrados, identificador do Account criador rastreando responsabilidade administrativa, identificador do tenant para isolamento multi-tenant, e timestamp UTC quando block foi criado para ordenação cronológica de subdivisões. Event handlers subscribers processam evento executando side effects como validar assincronamente que geometria do block está completamente dentro do boundary da community detectando configuração espacial inválida e disparando alerta para correção, validar que geometria não sobrepõe outros blocks existentes na mesma community prevenindo conflitos espaciais, invalidar cache de listagem de blocks da comunidade forçando refresh de queries que populam dropdowns de seleção em formulários de cadastro de unidades, atualizar índice espacial de busca indexando geometria do block para queries de intersecção permitindo detectar rapidamente em qual quadra uma coordenada GPS está localizada, registrar em audit trail criação de block para rastreabilidade de evolução da estrutura espacial especialmente importante para comunidades que transitam de irregular para formal com parcelamento do solo, incrementar contador de blocks por comunidade em dashboard de métricas atualizando estatísticas de cobertura territorial, gerar visualização de mapa exibindo novo block como camada vetorial auxiliando técnicos de campo a identificarem visualmente limites de quadra durante coleta, notificar gestores de regularização fundiária quando primeiro block é adicionado sinalizando que comunidade está sendo estruturada com parcelamento formal, e disparar recalculo de estatísticas de densidade habitacional agregando unidades por block permitindo análise de ocupação territorial. Motivação do evento permite organização hierárquica onde comunidades urbanas formais são subdivididas em quadras facilitando navegação e referência espacial similar a sistema de endereçamento tradicional, facilita validações espaciais onde unidades podem ser validadas contra block ao invés de apenas community reduzindo complexidade de queries geoespaciais, habilita workflows de aprovação onde blocks podem ser criados por técnicos mas requerem aprovação de gestor antes de liberação para cadastro de unidades, e suporta relatórios estruturados agregando estatísticas por quadra permitindo identificar áreas com maior densidade ou pendências de documentação. Regras de processamento estabelecem que evento é despachado após SaveChanges garantindo que Block entity foi persistida com geometria validada como polígono fechado, handlers de validação espacial executam assincronamente prevenindo bloqueio de operação principal, detecção de sobreposição com outros blocks dispara warning mas não impede criação permitindo correção manual posterior, e idempotência é requerida especialmente para indexação espacial evitando duplicação de geometria em índice em caso de retry de evento.

**Módulos:** GEOAPI, GEOWEB, REURBCAD, GEOGIS

---

**Última atualização:** 2026-01-10
**Status do arquivo**: Review
