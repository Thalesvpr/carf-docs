# Legitimation Status Transitions

Regras governando transições de status de LegitimationRequest através de workflow complexo de 11 estados conforme Lei 13465/2017 estabelecendo state machine rigorosa que controla processo completo de legitimação fundiária desde submissão inicial até emissão de certidão ou rejeição garantindo compliance legal rastreabilidade de decisões e integridade processual. Status possíveis conforme LegitimationStatus value object incluem DRAFT processo em preparação permite edição livre antes de submissão oficial, SUBMITTED processo submetido oficialmente inicia contagem de prazo de 120 dias conforme lei, UNDER_ANALYSIS processo sob análise preliminar analista atribuído está revisando documentação, DOCUMENT_REVIEW revisão aprofundada de documentação legal verificando conformidade jurídica, TECHNICAL_REVIEW validação de memorial descritivo e planta técnica por topógrafo ou engenheiro revisor, PUBLIC_NOTICE edital publicado em diário oficial iniciando publicidade obrigatória, CONTESTATION_PERIOD período de contestação ativo aguardando manifestações de terceiros durante 30 dias, RESOLUTION análise final consolidada após contestações resolvidas comissão decide aprovação ou rejeição, APPROVED processo aprovado autoriza emissão de certidão de legitimação, REJECTED processo rejeitado por impedimento legal ou técnico insuperável finaliza sem direito adquirido, e NEEDS_CORRECTION processo devolvido para correção requerente deve sanar pendências antes de resubmissão. Transições permitidas de DRAFT estabelecem DRAFT → SUBMITTED executável por MANAGER ou superior marcando início oficial de processo com pré-condições rigorosas incluindo protocol_number gerado, modality definido (REURB_S ou REURB_E), requester_name e requester_cpf válidos, legal_basis especificando artigos da Lei 13465/2017, Unit vinculada com status APPROVED, DescriptiveMemorial e LegitimationPlan vinculados e aprovados, documentação obrigatória anexada conforme modalidade (REURB-S requer declaração hipossuficiência REURB-E requer certidões negativas), ao menos um Holder vinculado à Unit com documentação pessoal completa, e verificação de ausência de LegitimationRequest ativo para mesma Unit prevenindo duplicação, transição dispara ações incluindo registrar submitted_at timestamp atual, calcular deadline_date como submitted_at + 120 dias, criar LegitimationResponse tipo SUBMISSION_ACKNOWLEDGEMENT com decision APPROVED, e emitir RequestSubmittedEvent notificando analistas e iniciando monitoramento de prazo, e DRAFT → DRAFT (permanecer) permitindo edições contínuas até documentação estar completa. Transições permitidas de SUBMITTED estabelecem SUBMITTED → UNDER_ANALYSIS executável por sistema automaticamente ao atribuir analyst_id ou manualmente por MANAGER atribuindo processo a analista específico sem pré-condições adicionais além de submissão válida iniciando análise preliminar, SUBMITTED → NEEDS_CORRECTION executável por ANALYST ou superior durante triagem inicial se documentação manifestly incompleta permitindo devolução rápida sem análise aprofundada, e SUBMITTED → REJECTED executável apenas por ADMIN em casos excepcionais de submissão claramente inválida (duplicata protocolo inválido fraude detectada) com justificativa obrigatória. Transições permitidas de UNDER_ANALYSIS estabelecem UNDER_ANALYSIS → DOCUMENT_REVIEW executável por ANALYST após análise preliminar positiva com decision APPROVED em LegitimationResponse tipo PRELIMINARY_ANALYSIS indicando que documentação básica está em ordem avançando para revisão jurídica aprofundada, UNDER_ANALYSIS → NEEDS_CORRECTION executável por ANALYST se deficiências sanáveis identificadas (documentação incompleta dados inconsistentes) criando LegitimationResponse com decision NEEDS_CORRECTION e lista de pendências em recommendations, UNDER_ANALYSIS → REJECTED executável por MANAGER se impedimento grave detectado (ocupação em área non aedificandi imóvel inexistente titular com múltiplas propriedades desqualificando REURB-S) com LegitimationResponse tipo PRELIMINARY_ANALYSIS decision REJECTED e justificativa detalhada, e UNDER_ANALYSIS → SUBMITTED executável por ANALYST permitindo retorno se análise não pode iniciar (informação crítica faltante aguardando resposta externa). Transições permitidas de DOCUMENT_REVIEW estabelecem DOCUMENT_REVIEW → TECHNICAL_REVIEW executável por ANALYST após revisão jurídica positiva com LegitimationResponse tipo LEGAL_REVIEW decision APPROVED indicando conformidade legal avançando para validação técnica de memorial e planta, DOCUMENT_REVIEW → NEEDS_CORRECTION executável por ANALYST se documentação legal insuficiente (fundamentação jurídica inadequada certidões desatualizadas anuências pendentes) com recommendations específicas, DOCUMENT_REVIEW → UNDER_ANALYSIS executável por ANALYST permitindo retorno se revisão jurídica detecta problemas que requerem nova análise preliminar, e DOCUMENT_REVIEW → APPROVED_WITH_CONDITIONS possível via LegitimationResponse decision APPROVED_WITH_CONDITIONS se aprovação jurídica é condicionada a providências (obtenção de licença ambiental regularização de débitos) avançando para TECHNICAL_REVIEW mas registrando pendências a serem verificadas antes de emissão de certidão. Transições permitidas de TECHNICAL_REVIEW estabelecem TECHNICAL_REVIEW → PUBLIC_NOTICE executável por sistema automaticamente ou MANAGER manualmente após LegitimationResponse tipo TECHNICAL_REVIEW decision APPROVED validando que memorial descritivo e planta técnica estão conformes iniciando fase de publicidade obrigatória, TECHNICAL_REVIEW → NEEDS_CORRECTION executável por ANALYST se documentação técnica requer ajustes (memorial inconsistente com planta área calculada diverge ART não recolhida) devolvendo para correção, TECHNICAL_REVIEW → DOCUMENT_REVIEW executável por ANALYST se revisão técnica detecta problema que requer nova análise jurídica (confrontações incorretas requerem verificação de titularidade de vizinhos), e pré-condição adicional verificando que SurveyProcessing vinculado tem precision adequada (h_precision_cm ≤10 para áreas urbanas conforme requisitos técnicos). Transições permitidas de PUBLIC_NOTICE estabelecem PUBLIC_NOTICE → CONTESTATION_PERIOD executável automaticamente após publicação de edital em diário oficial com registro de publication_date iniciando contagem de 30 dias para manifestações de terceiros, pré-condição verificando que edital foi efetivamente publicado (campo publication_reference preenchido com número de diário oficial ou protocolo de publicação), e transição dispara criação de notification enviada a confrontantes identificados quando informação disponível conforme exigência legal de notificação de vizinhos. Transições permitidas de CONTESTATION_PERIOD estabelecem CONTESTATION_PERIOD → RESOLUTION executável automaticamente após expiração de prazo de 30 dias sem contestações recebidas ou manualmente por MANAGER após todas Contestations recebidas terem sido analisadas com LegitimationResponse específicas indicando decisão sobre cada objeção, pré-condição verificando que nenhuma Contestation pendente de análise existe (todas têm LegitimationResponse vinculada), e CONTESTATION_PERIOD → REJECTED executável por MANAGER se Contestation procedente (UPHELD) foi identificada impedindo legitimação com justificativa fundamentada na objeção acolhida. Transições permitidas de RESOLUTION estabelecem RESOLUTION → APPROVED executável por MANAGER ou comissão responsável após análise final consolidada com LegitimationResponse tipo FINAL_DECISION decision APPROVED verificando pré-condições rigorosas incluindo todas análises (preliminar jurídica técnica contestações) foram concluídas com decisões favoráveis (APPROVED ou APPROVED_WITH_CONDITIONS), condições impostas em decisões condicionadas foram cumpridas pelo requerente (documentos adicionais apresentados providências tomadas), prazo de 120 dias não foi excedido ou se foi há extensão justificada registrada, nenhum impedimento legal foi identificado ao longo do processo, e Unit vinculada permanece em status APPROVED sem alterações que desqualifiquem legitimação, RESOLUTION → REJECTED executável por MANAGER com LegitimationResponse tipo FINAL_DECISION decision REJECTED fundamentando motivos de rejeição após análise completa (contestação procedente impedimento técnico ou legal insuperável documentação inadequada mesmo após correções), e RESOLUTION → NEEDS_CORRECTION executável por MANAGER em casos raros onde análise final identifica pendência adicional não detectada anteriormente requerendo nova correção antes de decisão definitiva. Transições permitidas de APPROVED estabelecem APPROVED → estado terminal sem transições automáticas processo permanece aprovado indefinidamente até emissão de LegitimationCertificate que registra certificate_id mas não altera status, APPROVED → RESOLUTION executável apenas por ADMIN em casos excepcionalíssimos de erro detectado após aprovação (fraude descoberta informação nova invalidando aprovação) com justificativa detalhada e aprovação de autoridade superior requerendo revisão antes de reverter aprovação concedida, e emissão de certidão a partir de APPROVED cria LegitimationCertificate vinculado registrando issue_date certificate_number mas mantendo status APPROVED permitindo rastreamento de quando certidão foi efetivamente emitida. Transições permitidas de REJECTED estabelecem REJECTED → estado terminal em maioria de casos processo finalizado sem direito adquirido não permite transições automáticas, REJECTED → RESOLUTION executável apenas por ADMIN permitindo reabertura se decisão de rejeição foi revertida por recurso administrativo ou judicial nova evidência apresentada ou erro material identificado com justificativa obrigatória e documentação comprobatória anexada em LegitimationResponse, e bloqueio de criação de novo LegitimationRequest para mesma Unit se há processo REJECTED recente (exemplo últimos 6 meses) exceto com aprovação de ADMIN evitando resubmissões repetitivas sem correção de problemas fundamentais. Transições permitidas de NEEDS_CORRECTION estabelecem NEEDS_CORRECTION → SUBMITTED executável por requerente ou MANAGER após correções realizadas resubmetendo processo com documentação sanada retornando para início de workflow mas preservando protocol_number original e histórico de LegitimationResponses anteriores permitindo rastreabilidade completa, NEEDS_CORRECTION → DRAFT executável por requerente permitindo retorno para edição livre se correções requerem mudanças substanciais (alteração de modalidade revisão de memorial descritivo), e NEEDS_CORRECTION → REJECTED executável por MANAGER se requerente não sana pendências dentro de prazo estipulado (exemplo 30 dias) ou manifesta desistência formalizando encerramento de processo sem aprovação. Enforcement de transições similar a Unit implementa state machine no backend validando requisições verificando transição permitida role adequado pré-condições atendidas registrando em AuditLog e disparando eventos de domínio, monitoramento de prazos através de job agendado executando diariamente verificando LegitimationRequests em andamento calculando dias restantes até deadline_date disparando DeadlineApproachingEvent quando faltam 15 dias alertando gestores sobre processos em risco de atraso, e dashboard consolidado exibindo distribuição de processos por status métricas de tempo médio em cada etapa taxa de aprovação rejeição e correções permitindo gestão eficiente de carteira e identificação de gargalos no workflow.

**Relacionado:**
- Entities: LegitimationRequest, LegitimationResponse, LegitimationCertificate, Contestation, Unit, DescriptiveMemorial, LegitimationPlan
- Value Objects: LegitimationStatus, Decision
- Aggregates: LegitimationRequest Aggregate
- Business Rules: reurb-s-requirements.md, reurb-e-requirements.md, contestation-rules.md
- Workflows: legitimation-workflow.md

---

**Última atualização:** 2025-01-05
