# Role (Papel de Usuário no Sistema)

Value object enum imutável representando papel funcional de usuário no sistema definindo nível de acesso permissões e responsabilidades conforme hierarquia organizacional implementando controle de acesso baseado em roles (RBAC). Valores possíveis incluem SUPER_ADMIN representando super administrador com acesso irrestrito a todas funcionalidades de todos tenants incluindo capacidade de gerenciar tenants criar administradores de tenant visualizar e modificar dados de qualquer organização e acessar configurações globais do sistema (role destinada a operadores da plataforma SaaS não a usuários finais de tenants específicos), ADMIN representando administrador de tenant com acesso completo a funcionalidades do seu próprio tenant incluindo gerenciamento de usuários criação de teams configuração de comunidades aprovação de processos e emissão de certidões mas sem acesso a dados de outros tenants (role para gestor máximo de prefeitura ou empresa de topografia), MANAGER representando gestor operacional com permissões de supervisão aprovação e decisões críticas podendo revisar e aprovar processos de legitimação gerenciar atribuição de trabalho a analistas visualizar relatórios consolidados mas sem capacidade de gerenciar usuários ou configurações de sistema (role para coordenador de equipe ou chefe de departamento), ANALYST representando analista técnico responsável por análise e validação de processos podendo revisar documentação emitir pareceres técnicos validar dados topográficos e recomendar aprovação ou rejeição mas sem autoridade para decisão final ou emissão de certidões (role para técnico qualificado de nível intermediário), e FIELD_AGENT representando agente de campo com acesso limitado a coleta de dados em campo podendo criar e editar units e holders em modo offline via app mobile tirar fotos anexar documentos mas sem capacidade de aprovar processos visualizar dados de outras equipes ou acessar funcionalidades administrativas (role para técnico de campo junior ou temporário). Hierarquia de permissões estabelece ordem decrescente de privilégios onde SUPER_ADMIN > ADMIN > MANAGER > ANALYST > FIELD_AGENT e role superior herda todas permissões de roles inferiores (ADMIN pode fazer tudo que MANAGER ANALYST e FIELD_AGENT fazem, MANAGER pode fazer tudo que ANALYST e FIELD_AGENT fazem), validação de permissão verifica se role do usuário autenticado tem nível suficiente para ação solicitada (criar ApiKey requer ADMIN, aprovar LegitimationRequest requer MANAGER, criar Unit permite FIELD_AGENT), e operações críticas podem requerer role específico exato ao invés de hierárquico (emitir LegitimationCertificate requer ADMIN ou MANAGER mas não SUPER_ADMIN que é operador de plataforma externo). Uso em Account estabelece que cada usuário tem exatamente um role global armazenado em Account.role determinando permissões base, role pode variar por Team onde usuário pode ser MEMBER em um team e LEADER em outro via TeamMember.team_role mas role de Account prevalece para operações fora de contexto de team, role determina visibilidade de menu e features em interface (FIELD_AGENT vê apenas formulários de cadastro e sincronização, ANALYST vê também fila de análise e relatórios, MANAGER vê dashboard executivo e aprovações pendentes, ADMIN vê configurações e gerenciamento de usuários), e mudança de role de usuário requer ação de administrador com role superior (ADMIN pode promover ANALYST para MANAGER, MANAGER não pode promover ninguém pois não tem role superior a delegar). Regras de atribuição estabelecem que novo usuário criado via convite recebe role padrão FIELD_AGENT sendo promovido posteriormente se necessário garantindo privilégio mínimo inicial, primeiro usuário de novo tenant é automaticamente ADMIN permitindo bootstrap de configuração inicial, SUPER_ADMIN só pode ser atribuído via acesso direto ao banco de dados ou script administrativo da plataforma prevenindo escalação não autorizada de privilégios, e role não pode ser removido (Account.role é obrigatório) apenas alterado para role diferente mantendo sempre usuário com role explícito conhecido. Permissões por role agrupadas por área funcional incluem Units (FIELD_AGENT create read update, ANALYST delete approve bulk-edit, MANAGER force-delete import-shapefile, ADMIN configure-validation-rules), Holders (FIELD_AGENT create read update, ANALYST delete validate-cpf, MANAGER merge-duplicates, ADMIN), LegitimationRequest (ANALYST create review assign-to-self, MANAGER approve reject issue-certificate, ADMIN cancel-request edit-after-approval), Teams (MANAGER create assign-users, ADMIN delete change-leader), Users (ADMIN create deactivate change-role assign-to-team, SUPER_ADMIN impersonate access-all-tenants), e Reports (FIELD_AGENT basic-reports, ANALYST detailed-reports export-pdf, MANAGER executive-dashboard cross-community-reports, ADMIN tenant-wide-analytics usage-statistics). Sistema valida role em múltiplas camadas onde API endpoint verifica role antes de processar requisição retornando HTTP 403 Forbidden se insuficiente, serviço de domínio verifica role ao executar operação de negócio lançando UnauthorizedException se usuário não tem permissão, queries de banco filtram dados por role automaticamente (FIELD_AGENT só vê Units de Communities que seu Team tem CommunityAuthorization, ANALYST vê Units de Communities do tenant inteiro, ADMIN vê tudo), e interface esconde controles ou páginas que usuário não pode acessar prevenindo confusão e tentativas fúteis de executar operações não permitidas. Auditoria de uso de permissões rastreia quais roles executam quais operações gerando relatório de análise de uso permitindo identificar se roles foram bem dimensionados ou se ajustes são necessários (se ANALYST nunca usa permissão de bulk-edit talvez deveria ser movida para MANAGER, se FIELD_AGENT frequentemente precisa solicitar que ANALYST faça algo talvez deveria ganhar permissão adicional), detecção de anomalias alerta se usuário com role baixo tenta repetidamente acessar recurso restrito sugerindo possível tentativa de escalação de privilégios ou necessidade legítima de promoção de role, e sistema pode sugerir automaticamente promoção de role quando padrões de uso indicam que usuário consistentemente precisa de permissões além do seu role atual.

**Implementações por projeto:**
- Backend .NET: `PROJECTS/GEOAPI/LAYERS/DOMAIN/VALUE-OBJECTS/25-role.md`
- Frontend React: `PROJECTS/GEOWEB/UTILS/VALUE-OBJECTS/role.ts`
- Mobile React Native: `PROJECTS/REURBCAD/UTILS/role.ts`
- Plugin GIS Python: `PROJECTS/GEOGIS/utils/role.py`

---

**Última atualização:** 2025-01-05
