# Layer (Camada Vetorial Customizada)

Entidade representando camada vetorial customizada criada por usuários para visualização de informações geográficas adicionais sobre comunidades como infraestrutura existente áreas de risco zoneamento urbano limites administrativos ou qualquer informação espacial relevante ao contexto do projeto de regularização fundiária. Campos conceituais incluem identificador único global, tenant_id vinculando camada ao tenant proprietário garantindo isolamento multi-tenant, nome descritivo da camada (Rede Elétrica, Áreas de Risco, Equipamentos Públicos), descrição textual explicando propósito e fonte dos dados, geometry_type enum especificando tipo de geometria permitido (POINT LINESTRING POLYGON MULTIPOINT MULTILINESTRING MULTIPOLYGON) garantindo consistência de todos features da camada, style_json configuração de estilo visual em formato JSON especificando cores espessuras ícones opacidade e outros atributos de renderização, visible_by_default booleano indicando se camada deve aparecer ativa ao carregar mapa ou se usuário precisa ativar manualmente, z_index inteiro controlando ordem de empilhamento de camadas no mapa (valores maiores aparecem sobre menores), visible_to_roles array JSON de roles autorizados a visualizar camada implementando controle de acesso granular onde camadas sensíveis (áreas de operação policial) podem ser restritas a roles específicos (ADMIN MANAGER), metadata JSON estruturado armazenando informações adicionais sobre fonte dos dados data de atualização responsável por criação licença de uso ou qualquer metadado relevante, created_by referenciando Account do usuário que criou camada estabelecendo responsabilidade, created_at timestamp de criação, updated_at timestamp de última modificação, e deleted_at timestamp de soft delete permitindo recuperação de camadas deletadas acidentalmente. Relacionamentos incluem pertence a Tenant (N:1 isolamento multi-tenant), foi criada por Account (N:1 rastreabilidade), e possui múltiplas LayerFeatures geometrias individuais (1:N representando pontos linhas ou polígonos da camada). Regras de negócio estabelecem que geometry_type deve ser consistente com geometrias de todos features associados impedindo mistura de tipos incompatíveis (não pode ter POINT e POLYGON na mesma camada), style_json deve seguir especificação de estilo do sistema de mapas usado (Mapbox GL Style ou similar mas sem mencionar tecnologia específica em docs agnósticas) validando estrutura JSON antes de salvar, visible_to_roles se vazio permite acesso a todos roles autenticados implementando permissão padrão aberta, z_index deve ser único por tenant prevenindo ambiguidade de sobreposição (ou sistema resolve automaticamente ajustando valores conflitantes), nome deve ser único por tenant evitando confusão entre camadas com nomes duplicados, e soft delete preserva camadas referenciadas por configurações de usuário ou relatórios salvos permitindo recuperação via undelete se necessário. Uso típico permite ADMIN ou MANAGER criar camada de infraestrutura (Rede de Água) especificando geometry_type=LINESTRING e style_json definindo linhas azuis espessura 2px, adicionar LayerFeatures individuais representando trechos de rede com atributos como diâmetro material ano de instalação, camada aparece em interface de mapa como checkbox permitindo usuários ativar ou desativar visualização conforme necessidade, analistas usam camada como referência durante validação de Units verificando se propriedades estão próximas a infraestrutura existente ou dentro de áreas de risco, e gestor pode criar camada temporária de planejamento (Expansão Futura) visível apenas para ADMIN/MANAGER auxiliando decisões estratégicas sem expor informação a campo. Sistema valida que features adicionados à camada têm geometry_type compatível rejeitando tentativas de adicionar polígono a camada de pontos, renderiza camadas em ordem de z_index garantindo que camadas importantes (limites de comunidade) apareçam sobre camadas de contexto (vias), aplica filtro de visible_to_roles ao carregar mapa ocultando camadas restritas de usuários sem permissão, e permite exportação de camada para formatos GIS padrão (GeoJSON Shapefile KML) facilitando compartilhamento de dados com sistemas externos ou ferramentas GIS desktop. Camadas customizadas complementam camadas base do sistema (Units Communities Blocks) fornecendo flexibilidade para representar informações específicas de contexto local que variam entre tenants, diferenciam-se de WmsLayers que consomem imagens raster de servidores externos enquanto Layers armazenam geometrias vetoriais editáveis criadas por usuários, e permitem análises espaciais como verificar quais Units estão dentro de área de risco ou a menos de 100m de infraestrutura crítica apoiando decisões técnicas e planejamento urbano.

**Módulos:** GEOAPI, GEOWEB, REURBCAD, GEOGIS

---

**Última atualização:** 2026-01-10
