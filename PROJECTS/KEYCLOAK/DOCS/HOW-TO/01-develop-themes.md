# Como Desenvolver Temas para Keycloak

Desenvolvimento de temas Keycloak CARF requer Docker instalado, editor VS Code recomendado, conhecimento básico HTML CSS JavaScript e FreeMarker opcional. Estrutura de diretórios navegando para PROJECTS/KEYCLOAK/SRC-CODE/carf-keycloak criando themes/carf/login/resources/css js img e messages, themes/carf/account/resources/css js, themes/carf/email/html text.

Keycloak em modo desenvolvimento via docker-compose.dev.yml definindo service keycloak image quay.io/keycloak/keycloak:24.0.0 command start-dev environment KEYCLOAK_ADMIN admin KEYCLOAK_ADMIN_PASSWORD admin KC_HTTP_PORT 8080 KC_HOSTNAME_STRICT false ports 8080:8080 volumes mapeando ./themes para /opt/keycloak/themes e ./realm-export.json para /opt/keycloak/data/import/realm.json:ro, command start-dev --import-realm, iniciar docker-compose -f docker-compose.dev.yml up, acessar http://localhost:8080.

Configuração inicial tema criando themes/carf/login/theme.properties com parent=keycloak.v2 import=common/keycloak styles=css/login.css scripts=js/login.js locales=pt-BR,en meta viewport width=device-width initial-scale=1 favicon img/favicon.ico.

Template base themes/carf/login/template.ftl usando macro registrationLayout com parâmetros bodyClass displayInfo displayMessage displayRequiredFields, DOCTYPE html lang locale, head com meta charset utf-8 viewport robots noindex nofollow, title usando msg loginTitle realm.displayName, processamento dinâmico properties.meta e properties.styles para incluir CSS e scripts JavaScript, body com classes kcBodyClass bodyClass, container kc-container kc-container-wrapper, header kc-header com logo img src url.resourcesPath/img/logo.svg e títulos msg carf.title carf.subtitle, content area kc-content kc-content-wrapper processando mensagens alert alert-type para success warning error info, nested sections header form info, footer kc-footer msg carf.footer.

Página login themes/carf/login/login.ftl importando template.ftl usando registrationLayout macro, section header com h2 kc-page-title msg loginAccountTitle, section form com form kc-form-login action url.loginAction method post, form-group label username processando realm.loginWithEmailAllowed e realm.registrationEmailAsUsername, input id username class form-control type text autofocus placeholder msg username, validação messagesPerField.existsError mostrando error-message span, form-group password input type password, form-options checkbox rememberMe se realm.rememberMe e link forgot-password href url.loginResetCredentialsUrl msg doForgotPassword, botão submit btn btn-primary btn-block name login id kc-login msg doLogIn, section info com link registro url.registrationUrl msg doRegister se realm.registrationAllowed.

Estilos CSS themes/carf/login/resources/css/login.css com variáveis CSS root --carf-primary #2C5F2D --carf-secondary #97BC62 --carf-accent #FFB300 --carf-background #F5F5F5 --carf-text #333333 --carf-error #D32F2F --carf-border #E0E0E0 --font-family Inter apple-system BlinkMacSystemFont Segoe UI sans-serif. Reset e base box-sizing border-box margin padding 0, body font-family background linear-gradient 135deg primary secondary min-height 100vh flex center padding 2rem 1rem. Container kc-container max-width 450px, wrapper background white border-radius 16px box-shadow 0 10px 40px rgba0,0,0,0.15. Header kc-header background linear-gradient primary to #234d24 padding 3rem 2rem text-align center color white, img max-width 180px margin-bottom 1rem, h1 font-size 1.5rem font-weight 700. Content kc-content padding 2.5rem, kc-page-title font-size 1.5rem font-weight 600 margin-bottom 2rem text-align center. Formulário form-group margin-bottom 1.5rem, form-label font-weight 500 font-size 0.875rem, form-control width 100% padding 0.875rem 1rem font-size 1rem border 2px solid border-radius 8px transition 0.3s, focus outline none border-color primary box-shadow 0 0 0 3px rgba. Botões btn padding 1rem 1.5rem font-weight 600 border-radius 8px cursor pointer transition 0.3s, btn-primary background primary color white hover background #234d24 transform translateY -2px box-shadow 0 6px 20px rgba. Alertas alert padding 1rem border-radius 8px margin-bottom 1.5rem flex align-items center, alert-error background #FFEBEE color error border-left 4px solid error, alert-success background #E8F5E9 color #2E7D32, alert-warning background #FFF3E0 color #F57C00, alert-info background #E3F2FD color #1976D2. Registro kc-registration-container margin-top 2rem padding-top 2rem border-top 1px solid border text-align center, link color primary font-weight 600 hover text-decoration underline. Footer kc-footer text-align center padding 1.5rem color white font-size 0.875rem opacity 0.9. Responsividade media max-width 576px body padding 1rem 0.5rem kc-content padding 2rem 1.5rem kc-header padding 2rem 1.5rem form-options flex-direction column gap 0.75rem. Acessibilidade media prefers-reduced-motion reduce animation-duration 0.01ms transition-duration 0.01ms.

JavaScript customizado themes/carf/login/resources/js/login.js com DOMContentLoaded listener, máscara CPF para campo username detectando 11 dígitos aplicando formato XXX.XXX.XXX-XX via replace regex, validação básica formulário login verificando username e password preenchidos antes submit, auto-focus no campo username se vazio.

Internacionalização themes/carf/login/messages/messages_pt_BR.properties com loginAccountTitle=Entre com sua conta carf.title=Sistema CARF carf.subtitle=Regularização Fundiária Urbana carf.footer=© 2025 CARF - Todos os direitos reservados, campos username=CPF usernameOrEmail=CPF ou Email password=Senha rememberMe=Lembrar-me neste dispositivo doForgotPassword=Esqueci minha senha, botões doLogIn=Entrar doRegister=Criar uma conta doCancel=Cancelar doSubmit=Enviar, registro noAccount=Não tem uma conta? registerTitle=Criar Conta, mensagens erro invalidUserMessage=CPF ou senha inválidos loginTimeout=Sua sessão expirou accountDisabledMessage=Sua conta está desabilitada accountTemporarilyDisabledMessage=Sua conta está temporariamente bloqueada, LGPD termsTitle=Termos de Uso e Política de Privacidade termsText=Ao se cadastrar você concorda com nossos Termos conforme LGPD termsAccept=Li e aceito os termos.

Teste do tema acessando Admin Console http://localhost:8080 login admin/admin, selecionar realm carf, Realm Settings Themes, Login Theme carf, Save. Testar páginas login http://localhost:8080/realms/carf/account, registro ativar em Realm Settings Login User Registration, esqueci senha clicar link na página login. Hot reload mudanças CSS JS recarregadas automaticamente, templates .ftl podem precisar restart docker-compose restart.

Debugging via Browser DevTools F12 Inspector para HTML CSS, Console para erros JavaScript, Network para verificar carregamento recursos. Logs Keycloak docker-compose logs -f keycloak. Template errors FreeMarker mostram stack trace no navegador em modo dev.

Build produção minificar CSS JS instalando csso-cli uglify-js via npm install -g, minificar csso login.css -o login.min.css uglifyjs login.js -o login.min.js, atualizar theme.properties styles=css/login.min.css scripts=js/login.min.js, build imagem Docker docker build -t carf-keycloak:latest -f docker/Dockerfile.custom.

Próximos passos desenvolver tema Account, tema Email, adicionar mais páginas register.ftl error.ftl, implementar testes automatizados, documentar guia contribuição. Referências Keycloak Theme SPI keycloak.org/docs/latest/server_development/#_themes, FreeMarker Documentation freemarker.apache.org/docs, CSS Variables MDN developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties.

---

**Última atualização:** 2026-01-12
**Status do arquivo**: Pronto
