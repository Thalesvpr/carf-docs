Service Provider Interfaces (SPIs) do Keycloak são pontos de extensão server-side implementados via JARs Java colocados em `/opt/keycloak/providers/` permitindo customizar comportamento core através de interfaces como Authenticator (custom authentication flows com steps configuráveis implementando authenticate/action/requiresUser/configuredFor retornando AuthenticationFlowContext), EventListenerProvider (interceptar eventos como LOGIN/LOGOUT/REGISTER/UPDATE_PROFILE salvando em banco externo ou enviando para fila Kafka implementando onEvent(Event event) e onAdminEvent(AdminEvent event)), ProtocolMapper (adicionar/modificar claims no JWT token como tenant_id extraído de user attributes implementando transformAccessToken(AccessToken token, ProtocolMapperModel mapper, KeycloakSession session, UserSessionModel userSession, ClientSessionContext clientSession) retornando token modificado), RequiredActionProvider (forçar ações como verificar email, atualizar senha, aceitar termos implementando evaluateTriggers/requiredActionChallenge/processAction), UserStorageProvider (integrar user store externo como LDAP, Active Directory, banco legado implementando getUserByUsername/getUserById/searchForUser/validateCredentials permitindo SSO com sistemas existentes), Theme ResourceProvider (servir assets customizados dinamicamente).

Todas SPIs registradas via factory pattern implementando ProviderFactory com getId/init/postInit/close seguindo Service Loader pattern Java lendo META-INF/services/org.keycloak.provider.Spi para descoberta automática durante boot do Keycloak, buildadas via Maven com keycloak-server-spi como provided dependency gerando JAR uber (fat JAR com dependencies shaded exceto Keycloak APIs), hot-reloadable em modo dev mas exigindo restart em produção, configuradas via Admin Console em Authentication → Flows para Authenticators ou Realm Settings → Events → Config para Event Listeners ou Client Scopes → Mappers para Protocol Mappers.

Testadas via Arquillian framework com keycloak-testsuite e KeycloakTestingClient para testes de integração rodando Keycloak embedded, versionadas junto com código em `PROJECTS/KEYCLOAK/SRC-CODE/carf-keycloak/extensions/` estruturado como Maven multi-module com pom parent definindo Keycloak version, debuggable via remote JVM debug habilitando JAVA_OPTS com `-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:8787` e anexando IntelliJ/Eclipse debugger para step debugging durante requisições reais facilitando troubleshooting de lógica complexa como custom CPF authentication validator ou tenant-based authorization rules.

---

**Última atualização:** 2026-01-15
**Status do arquivo**: Incompleto
Descrição: Falta título H1 na primeira linha.
