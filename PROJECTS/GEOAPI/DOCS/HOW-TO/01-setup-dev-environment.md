# Setup Dev Environment - GEOAPI

Setup ambiente desenvolvimento GEOAPI requer instalação .NET 9 SDK obtido via winget install Microsoft.DotNet.SDK.9 no Windows brew install dotnet-sdk macOS apt-get install dotnet-sdk-9.0 Ubuntu verificando versão dotnet --version retornando 9.0.x, Docker Desktop baixado docker.com/products/docker-desktop Windows macOS docs.docker.com/engine/install Linux verificando docker --version docker-compose --version, clonar repositório git clone https://github.com/user/carf-geoapi.git PROJECTS/GEOAPI/SRC-CODE navegando cd PROJECTS/GEOAPI/SRC-CODE, subir PostgreSQL PostGIS criando docker-compose.yml raiz projeto definindo service postgres image postgis/postgis:16-3.4 container_name geoapi-db environment POSTGRES_DB geoapi_dev POSTGRES_USER geoapi POSTGRES_PASSWORD dev123 ports 5432:5432 volumes postgres_data healthcheck pg_isready verificando disponibilidade executando docker-compose up -d verificando docker ps mostrando geoapi-db status healthy, configurar connection string appsettings.Development.json ConnectionStrings DefaultConnection Host localhost Port 5432 Database geoapi_dev Username geoapi Password dev123 Keycloak Authority http://localhost:8080/realms/carf Audience geoapi RequireHttpsMetadata false desenvolvimento Logging LogLevel Default Information EntityFrameworkCore Warning evitando ruído logs, criar aplicar migrations navegando src/Carf.GEOAPI.Infrastructure executando dotnet ef migrations add Initial --startup-project ../Carf.GEOAPI.Gateway --context AppDbContext gerando pasta Migrations schema inicial dotnet ef database update aplicando migrations criando tabelas RLS policies verificando docker exec -it geoapi-db psql -U geoapi -d geoapi_dev -c listando tabelas criadas units holders communities legitimation_requests, configurar Keycloak subindo docker run -d --name keycloak -p 8080:8080 -e KEYCLOAK_ADMIN=admin -e KEYCLOAK_ADMIN_PASSWORD=admin quay.io/keycloak/keycloak:23.0 start-dev aguardando inicialização trinta sessenta segundos acessando http://localhost:8080 login admin admin importando realm via UI Select realm Create Realm Browse selecionando CENTRAL/INTEGRATION/KEYCLOAK/realm-export.json Create ou CLI copiando docker cp CENTRAL/INTEGRATION/KEYCLOAK/realm-export.json keycloak:/tmp/ importando docker exec keycloak /opt/keycloak/bin/kc.sh import --file /tmp/realm-export.json --override true, rodar API voltando raiz projeto dotnet restore restaurando dependências dotnet build compilando navegando src/Carf.GEOAPI.Gateway dotnet run iniciando servidor HTTPS https://localhost:7001 HTTP http://localhost:5001 Swagger https://localhost:7001/swagger documentação interativa endpoints, configurar IDE Visual Studio 2022 abrindo Carf.GEOAPI.sln definindo Carf.GEOAPI.Gateway startup project F5 debugger ou VS Code instalando extensões code --install-extension ms-dotnettools.csharp ms-dotnettools.csdevkit formulahendry.dotnet-test-explorer configurando .vscode/launch.json definindo configuration name Launch GEOAPI type coreclr request launch preLaunchTask build program bin/Debug/net9.0/Carf.GEOAPI.Gateway.dll cwd src/Carf.GEOAPI.Gateway env ASPNETCORE_ENVIRONMENT Development, verificar setup health check curl https://localhost:7001/health retornando status Healthy Swagger UI abrindo navegador mostrando endpoints database connectivity curl https://localhost:7001/health/db retornando status Healthy database Connected confirmando comunicação PostgreSQL PostGIS.

## Troubleshooting

Erro Port 5432 already in use resolver parando PostgreSQL local Windows services.msc PostgreSQL Stop macOS Linux sudo systemctl stop postgresql ou trocando porta docker-compose.yml ports 5433:5432 usando porta alternativa atualizando connection string correspondentemente, Migrations failing deletar banco recriar docker exec -it geoapi-db psql -U postgres -c DROP DATABASE geoapi_dev CREATE DATABASE geoapi_dev OWNER geoapi aplicando migrations novamente dotnet ef database update --startup-project ../Carf.GEOAPI.Gateway fresh start, Keycloak not accessible verificar container rodando docker ps grep keycloak ver logs docker logs keycloak identificando problemas inicialização reiniciar container docker restart keycloak aguardar novamente trinta segundos testar acesso http://localhost:8080 navegador, problemas permissões Windows antivirus firewall bloqueando Docker containers adicionar exceções defender.exe docker.exe permitindo comunicação localhost ports desenvolvimento, performance lenta primeira execução EF Core compilando queries cache melhorando execuções subsequentes migrations grandes volumes dados considerar batch inserts seed data otimizando startup time.

## Referências

Documentação .NET 9 SDK instalação configuração PATH variáveis ambiente troubleshooting disponível dotnet.microsoft.com/download Microsoft Learn incluindo tutoriais getting started ASP.NET Core Entity Framework minimal APIs, Docker Desktop containerização local desenvolvimento docker.com/products/docker-desktop suportando Windows WSL2 macOS Apple Silicon Intel Linux diversas distribuições Docker Compose orquestração multi-container networking volumes, Entity Framework Core CLI comandos migrations scaffold update database reverter alterações schema gerenciamento versões documentado Microsoft Learn ef/core/cli/dotnet fornecendo exemplos práticos troubleshooting common issues, PostgreSQL PostGIS configuração ambiente desenvolvimento setup Docker Keycloak importação realm configuração clients OAuth2 runbooks scripts automação encontram-se CENTRAL/INTEGRATION seções DATABASE KEYCLOAK respectivamente fornecendo troubleshooting problemas permissões conexão rede firewall garantindo ambiente consistente desenvolvedores equipe.

---

**Última atualização:** 2026-01-12
**Status do arquivo**: Pronto
