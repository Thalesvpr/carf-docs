# Reporting - Relatórios

Feature de reporting implementada permitindo usuários gerarem relatórios comunidade dashboard metrics exportarem dados geográficos múltiplos formatos através de páginas ReportsPage dashboard widgets cards mostrando aggregated metrics total units por status caracterização approval rates charts Recharts LineChart BarChart PieChart visualizando trends temporal spatial distributions, CommunityReportPage formulário seleção community date range filters gerando PDF relatório completo via react-pdf Document rendering server-side ou client-side, ExportPage seleção format Shapefile GeoJSON KML CSV Excel filtering criteria downloading files, componentes principais MetricsCard exibindo number label trend icon color coding green increase red decrease, ChartsContainer grid layout ResponsiveContainer wrapping charts auto-sizing, ReportFiltersForm dropdowns date pickers multi-select communities statuses características, ExportFormatSelector radio buttons Shapefile GeoJSON KML CSV Excel com descriptions formats supported, DownloadButton triggering export API call showing progress spinner toast success failure.

Validações implementadas verificando date range selection start_date anterior end_date max 1 year range evitando queries pesadas timeout, community selection min 1 max 10 communities simultaneously reasonable limit evitando memory overflow large datasets, format validation checking supported formats rejeitando unsupported extensions, export size limit max 10000 records per export preventing performance issues large datasets offering pagination batch exports, filters consistency checking status caracterização combinations valid não contraditórios, data availability verificando selected filters retornam pelo menos 1 record alertando empty result set antes trigger export avoiding wasted processing, authentication permissions checking user role MANAGER ou ADMIN pode exportar todos dados ANALYST apenas approved units filtering server-side conforme permissions, tenant isolation garantindo exports contem apenas dados tenant atual via RLS policies backend.

API integration via GET /api/reports/metrics params tenant_id date_range filters retornando aggregated data total_units por status counts approval_rate percentage caracterizacao_distribution object, GET /api/reports/community/:id params date_range gerando PDF server-side via library PuppeteerSharp ou similar rendering HTML template com dados community units holders charts retornando binary PDF file downloadable, POST /api/exports body format filters tenant_id async job processing backend extracting data converting format Shapefile via NetTopologySuite GeoJSON via Newtonsoft.Json CSV via CsvHelper Excel via EPPlus retornando job_id, GET /api/jobs/:id polling status completed failed progress percentage download_url quando completed, charts data GET /api/reports/charts params type line bar pie period daily weekly monthly aggregation retornando series data labels values timestamps, download file via anchor element href download_url download attribute triggering browser download ou window.open opening new tab, caching metrics data TanStack Query staleTime 5 minutes refetchOnWindowFocus evitando queries desnecessárias dados não mudam frequentemente, background export processing via queue system backend RabbitMQ Hangfire evitando timeout large exports user recebe notification email quando export ready download.

Domain model metrics aggregated data TypeScript interfaces MetricsSummary com total_units number pending approved rejected counts approval_rate percentage temporal_distribution array objects date count, ChartData series array name data values labels timestamps, ExportJob id UUID status enum PENDING PROCESSING COMPLETED FAILED format tenant_id filters created_at download_url nullable, implementação UC-006 requirements incluindo gerar relatório comunidade selecionando community date range visualizando preview PDF downloading file, metrics dashboard aggregated totals charts temporal spatial distributions, implementação UC-007 incluindo exportar dados geográficos selecionando format Shapefile GeoJSON KML filters status caracterização communities, async processing large exports job tracking polling download ready, relacionamento requirements rastreando RF-014 RF-015 reporting analytics export geoespacial compliance transparency accountability.

---

**Última atualização:** 2026-01-11
**Status do arquivo**: Pronto
