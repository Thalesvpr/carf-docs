Token storage no GEOGIS usa QSettings QGIS built-in settings manager que automaticamente encrypts valores via platform password managers Keychain macOS KWallet ou Secret Service Linux GNOME KDE Windows Credential Manager garantindo tokens não armazenados plain text em config files usage pattern settings = QSettings('CARF', 'GEOGIS') criando settings object com organization 'CARF' e application 'GEOGIS' gerando namespace unique evitando conflicts com outros plugins settings.setValue('access_token', token) salva token encrypted passando para password manager backend automaticamente sem código adicional token = settings.value('access_token', defaultValue=None) lê token decrypted retornando None se não existe settings.remove('access_token') deleta token do password manager permanentemente.

Sensitive values como access_token refresh_token client_secret devem usar QSettings porque encrypted non-sensitive values como API_URL last_sync_time theme_preference podem usar regular QSettings ou Python config files porque não security risk QSettings automatically syncs ao disk periodically e durante app shutdown garantindo persistence across plugin reload QGIS restart location QSettings armazena depende de platform sendo macOS ~/Library/Preferences/com.CARF.GEOGIS.plist Linux ~/.config/CARF/GEOGIS.conf Windows HKEY_CURRENT_USER\Software\CARF\GEOGIS registry mas password manager entries armazenados separately em Keychain KWallet Credential Manager não plain text nestes files.

Debugging QSettings values via Settings Options Advanced Settings tree navegando CARF GEOGIS vendo keys mas values mostrados como encrypted strings não plaintext tokens migration de plain text storage se plugin versions antigas armazenavam tokens insecure então migration code em plugin upgrade lê old settings.value('token') salva via setValue() triggering encryption remove old key evitando deixar plain text residual token expiration tracking armazena expires_at timestamp via settings.setValue('expires_at', datetime.now().isoformat()) convertendo datetime para ISO string porque QSettings não suporta datetime objects directly ao ler converte back com datetime.fromisoformat(settings.value('expires_at')).

Backup considerations QSettings backup via QGIS profile export import não inclui encrypted password manager entries então após restore em novo machine user precisa re-login porque tokens não transferred alternativa armazenar apenas refresh_token porque long-lived dias semanas ao invés de access_token short-lived minutos reduzindo re-authentication frequency multi-profile support QGIS permite múltiplos profiles cada com QSettings isolated então user pode ter profile "Dev" conectando localhost Keycloak e profile "Prod" conectando production Keycloak sem interference switching profiles maintains separate authentication sessions credentials.

---

**Última atualização:** 2026-01-15
**Status do arquivo**: Incompleto
Descrição: Falta título H1 na primeira linha.
