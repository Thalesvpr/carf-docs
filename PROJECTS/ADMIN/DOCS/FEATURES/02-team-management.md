# Team Management - Gestão de Equipes

Feature de gestão de equipes técnicas implementada no ADMIN como interface SPA React TypeScript para criar editar visualizar e desativar teams permitindo usuários autorizados ADMIN e MANAGER organizarem colaboradores em grupos funcionais através de páginas TeamsListPage exibindo grid paginado com todas teams do tenant usando TanStack Query useQuery hook chamando GET /api/teams retornando array de team objects, TeamFormPage modal ou standalone para criar e editar teams com formulário React Hook Form gerenciado por useForm hook validando campos via Zod schema, TeamDetailsPage exibindo tabs para Membros Comunidades Atividades Métricas usando componentes reutilizáveis MembersTab CommunityAssignmentsTab, state management via Zustand store criando teamStore gerenciando selected team filter options (status role) e UI state (modal open sidebar expanded), componentes principais incluem TeamCard exibindo nome líder membros count status badge com ícones edit view deactivate, TeamTable alternativa usando Tanstack Table v8 com sorting filtering pagination server-side, AddMemberModal permitindo selecionar múltiplos usuários via checkboxes com filtros por role department, AssignCommunityModal listando communities disponíveis com geolocation map preview via React Leaflet.

Validações implementadas via React Hook Form integrado com Zod schemas definindo teamSchema validando name obrigatório unique via async validator custom debounced chamando GET /api/teams/validate-name params name tenantId retornando boolean exists, description opcional string max 500 chars, leader_id obrigatório UUID validando formato e existência via referential check chamando GET /api/users/:id verificando status ACTIVE, status enum com valores ACTIVE INACTIVE padrão ACTIVE, memberSchema array de objects validando user_id UUID role enum COORDINATOR ANALYST FIELD_AGENT unique members via custom validator verificando duplicated IDs Set size equals array length, communitySchema array de UUID validando cada community_id formato e existência, validação client-side rodando onChange mostrando errors inline em FormErrorMessage components, validação server-side repetindo checks no backend GEOAPI endpoints antes de persist garantindo security pois client manipulável.

API integration implementada via custom hooks useTeams hook wrapper encapsulando TanStack Query useQuery key teams filters sort retornando data isLoading error refetch methods, useCreateTeam mutation hook chamando POST /api/teams body team object onSuccess invalidando query cache via queryClient.invalidateQueries keys teams mostrando toast success, useUpdateTeam PATCH /api/teams/:id, useDeleteTeam DELETE logicamente setando status INACTIVE, useAddTeamMembers POST /api/teams/:id/members body array user IDs com roles, useAssignCommunities POST /api/teams/:id/communities, error handling via onError callbacks mostrando toast error messages parseando backend response errors array exibindo validation messages específicos, optimistic updates configurados em mutations options optimisticUpdate modificando cache antes de request para UX responsiva rollback automático se request falha, retry logic configurado TanStack Query retry 3 retryDelay exponential backoff, request interceptor adicionando Authorization Bearer header via axios instance obtendo token de AuthContext useAuth hook getAccessToken method.

Domain model mapeando CENTRAL entities Team com properties id UUID tenant_id name description leader User relation members array User objects via team_members junction communities array Community objects via team_communities created_by updated_by timestamps status enum, implementação UC-011 requirements incluindo criar team formulário modal validações unique name active leader, adicionar membros modal checkboxes roles assignment, atribuir comunidades geolocation filtering, editar team preservando members communities, desativar team soft delete mantendo histórico audit, listagem com filtros status search pagination server-side, detalhes tabs separando concerns, notificações email push para líder e membros adicionados via backend trigger, auditoria logging todas operações via backend audit_log table, security RBAC checking user roles via hasRole helper antes de render create edit actions, RLS backend PostgreSQL isolando teams por tenant_id garantindo multi-tenancy, relacionamento UC-011 implementando fluxo principal e alternativos conforme especificado requirements rastreando RF-024 RF-026 RF-050.

---

**Última atualização:** 2026-01-11
**Status do arquivo**: Pronto
